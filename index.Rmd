---
title: "ASHA's Political Campaign Donations and HRC Score Card"
author: "Brett Welch, MS, CCC-SLP"
date: "6/13/2023"
output: 
  html_document:
    toc: true
    toc_float: true
    code_folding: hide
    theme: sandstone
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = T,
                      warning = F,
                      message = F)
```


```{r}
library(tidyverse, quietly = T)
library(readxl)
library(gt)
library(kableExtra)
library(janitor)
library(pdftools)
library(plotly)

```



# Data

## ASHA-PAC's Spending{.tabset}

These data were obtained from [OpenSecrets.org](https://www.opensecrets.org/). Specifically data from ASHA-PAC's spending on [2020 House and Senate candidates](https://www.opensecrets.org/political-action-committees-pacs/american-speech-language-hearing-assn/C00210666/candidate-recipients/2020) and [2022 House and Senate candidates](https://www.opensecrets.org/political-action-committees-pacs/american-speech-language-hearing-assn/C00210666/candidate-recipients/2022). 

[Click here to see ASHA-PAC's Summary on OpenSecrets.org](https://www.opensecrets.org/political-action-committees-pacs/american-speech-language-hearing-assn/C00210666/summary/2022)

[Click here to learn about ASHA-PAC and view their Frequently Asked Questions page.](https://www.asha.org/advocacy/pac/faqsashapac/)

[Click here to see ASHA-PAC's current considerations when deciding who to donate to.](https://www.asha.org/advocacy/pac/candidate-contribution-criteria/)


### 2022{.tabset}

#### House

```{r}
asha_2022_rep <- read.csv("/Users/brett/Documents/R/PoliticalSpreadsheet/ASHA_PAC/ASHA_2022_candidateSpending_house.csv")

asha_2022_rep %>% separate(Candidate, 
                           into = c("Name", "ID"), 
                           sep = "\\(",
                           remove = F) %>%
  separate(ID,
           into = c("Party", "State"),
           sep = "\\-") -> asha_2022_rep

#Clean up state labels

asha_2022_rep %>%
  mutate(State = case_when(
    State == "Fla)" ~ "FL",
    State == "WVa)" ~ "WV",
    State == "Mass)" ~ "MA",
    State == "NJ)" ~ "NJ",
    State == "Calif)" ~ "CA",
    State == "Texas)" ~ "TX",
    State == "Ky)" ~ "KY",
    State == "Wash)" ~ "WA",
    State == "NC)" ~ "NC",
    State == "Wis)" ~ "WI",
    State == "Ill)" ~ "IL",
    State == "Va)" ~ "VA",
    State == "Pa)" ~ "PA",
    State == "NY)" ~ "NY",
    State == "Del)" ~ "DE",
    State == "Conn)" ~ "CT",
    State == "Ore)" ~ "OR",
    State == "Mich)" ~ "MI",
    State == "Vt)" ~ "VT",
    State == "Ohio)" ~ "OH",
    State == "Colo)" ~ "CO",
    State == "Md)" ~ "MD",
    State == "SC)" ~ "SC",
    State == "LA)" ~ "LA",
    State == "La)" ~ "LA",
    State == "Minn)" ~ "MN",
    State == "Okla)" ~ "OK",
    State == "Mo)" ~ "MO",
    State == "Nev)" ~ "NV",
    State == "Iowa)" ~ "IA",
    State == "Ga)" ~ "GA",
    State == "Ark)" ~ "AR",
    State == "NH)" ~ "NH",
    State == "Ariz)" ~ "AZ",
    State == "Ala)" ~ "AL",
    State == "Neb)" ~ "NE",
    State == "Maine)" ~ "ME",
    State == "Miss)" ~ "MS",
    State == "NM)" ~ "NM",
    State == "Ind)" ~ "IN",
    State == "ND)" ~ "ND",
    State == "Wyo)" ~ "WY",
    State == "Utah)" ~ "UT",
    
    TRUE ~ State
  )) -> asha_2022_rep

asha_2022_rep <- asha_2022_rep %>% clean_names()

asha_2022_rep$name <- str_squish(asha_2022_rep$name)

#convert total column to numeric
asha_2022_rep$total <- as.numeric(gsub("\\$", "", asha_2022_rep$total))

```

```{r}
paste("In the 2022 election cycle, ASHA-PAC donated a total of $", sum(asha_2022_rep$total), "to Representatives' campaigns.")
```


A list of Representatives ASHA-PAC donated money to for their 2022 campaign

```{r}
asha_2022_rep %>% 
  select(-candidate) %>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(height = "400px")
```


#### Senate

```{r}
asha_2022_sen <- read.csv("/Users/brett/Documents/R/PoliticalSpreadsheet/ASHA_PAC/ASHA_2022_candidateSpending_senate.csv")

asha_2022_sen %>% separate(Candidate, 
                           into = c("Name", "ID"), 
                           sep = "\\(",
                           remove = F) %>%
  separate(ID,
           into = c("Party", "State"),
           sep = "\\-") -> asha_2022_sen

asha_2022_sen %>%
  mutate(State = case_when(
    State == "Fla)" ~ "FL",
    State == "WVa)" ~ "WV",
    State == "Mass)" ~ "MA",
    State == "NJ)" ~ "NJ",
    State == "Calif)" ~ "CA",
    State == "Texas)" ~ "TX",
    State == "Ky)" ~ "KY",
    State == "Wash)" ~ "WA",
    State == "NC)" ~ "NC",
    State == "Wis)" ~ "WI",
    State == "Ill)" ~ "IL",
    State == "Va)" ~ "VA",
    State == "Pa)" ~ "PA",
    State == "NY)" ~ "NY",
    State == "Del)" ~ "DE",
    State == "Conn)" ~ "CT",
    State == "Ore)" ~ "OR",
    State == "Mich)" ~ "MI",
    State == "Vt)" ~ "VT",
    State == "Ohio)" ~ "OH",
    State == "Colo)" ~ "CO",
    State == "Md)" ~ "MD",
    State == "SC)" ~ "SC",
    State == "LA)" ~ "LA",
    State == "La)" ~ "LA",
    State == "Minn)" ~ "MN",
    State == "Okla)" ~ "OK",
    State == "Mo)" ~ "MO",
    State == "Nev)" ~ "NV",
    State == "Iowa)" ~ "IA",
    State == "Ga)" ~ "GA",
    State == "Ark)" ~ "AR",
    State == "NH)" ~ "NH",
    State == "Ariz)" ~ "AZ",
    State == "Ala)" ~ "AL",
    State == "Neb)" ~ "NE",
    State == "Maine)" ~ "ME",
    State == "Miss)" ~ "MS",
    State == "NM)" ~ "NM",
    State == "Ind)" ~ "IN",
    State == "ND)" ~ "ND",
    State == "Wyo)" ~ "WY",
    State == "Utah)" ~ "UT",
    State == "Alaska)" ~ "AK",
    State == "SD)" ~ "SD",
    
    TRUE ~ State
  )) -> asha_2022_sen

asha_2022_sen <- asha_2022_sen %>% 
  clean_names()

asha_2022_sen$name <- str_squish(asha_2022_sen$name)

#convert total column to numeric
asha_2022_sen$total <- as.numeric(gsub("\\$", "", asha_2022_sen$total))

```


```{r}
paste("In the 2022 election cycle, ASHA-PAC donated a total of $", sum(asha_2022_sen$total), "to Senators' campaigns.")
```

A list of Senators that ASHA-PAC donated money to for their 2022 campaign

```{r}
asha_2022_sen %>% 
  select(-candidate) %>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(height = "400px")
```



### 2020{.tabset}

#### House

```{r}
asha_2020_rep <- read.csv("/Users/brett/Documents/R/PoliticalSpreadsheet/ASHA_PAC/ASHA_2020_candidateSpending_house.csv")

asha_2020_rep %>% separate(Candidate, 
                           into = c("Name", "ID"), 
                           sep = "\\(",
                           remove = F) %>%
  separate(ID,
           into = c("Party", "State"),
           sep = "\\-") -> asha_2020_rep

#clean up labels for states

asha_2020_rep %>%
  mutate(State = case_when(
    State == "Fla)" ~ "FL",
    State == "WVa)" ~ "WV",
    State == "Mass)" ~ "MA",
    State == "NJ)" ~ "NJ",
    State == "Calif)" ~ "CA",
    State == "Texas)" ~ "TX",
    State == "Ky)" ~ "KY",
    State == "Wash)" ~ "WA",
    State == "NC)" ~ "NC",
    State == "Wis)" ~ "WI",
    State == "Ill)" ~ "IL",
    State == "Va)" ~ "VA",
    State == "Pa)" ~ "PA",
    State == "NY)" ~ "NY",
    State == "Del)" ~ "DE",
    State == "Conn)" ~ "CT",
    State == "Ore)" ~ "OR",
    State == "Mich)" ~ "MI",
    State == "Vt)" ~ "VT",
    State == "Ohio)" ~ "OH",
    State == "Colo)" ~ "CO",
    State == "Md)" ~ "MD",
    State == "SC)" ~ "SC",
    State == "LA)" ~ "LA",
    State == "Minn)" ~ "MN",
    State == "Okla)" ~ "OK",
    State == "Mo)" ~ "MO",
    State == "Nev)" ~ "NV",
    State == "Iowa)" ~ "IA",
    State == "Ga)" ~ "GA",
    State == "Ark)" ~ "AR",
    State == "NH)" ~ "NH",
    State == "Ariz)" ~ "AZ",
    State == "Ala)" ~ "AL",
    State == "Neb)" ~ "NE"
  )) -> asha_2020_rep

#unique(asha_2020_rep$State)

asha_2020_rep <- asha_2020_rep %>% clean_names()

asha_2020_rep$name <- str_squish(asha_2020_rep$name)

#convert total column to numeric
asha_2020_rep$total <- as.numeric(gsub("\\$", "", asha_2020_rep$total))
```


```{r}
paste("In the 2020 election cycle, ASHA-PAC donated a total of $", sum(asha_2020_rep$total), "to Representatives' campaigns.")
```

A list of Representatives ASHA-PAC donated money to for their 2020 campaign

```{r}
asha_2020_rep %>% 
  select(-candidate) %>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(height = "400px")


# asha_2020_rep %>%  #not a fan of the condensed form
#   select(-candidate) %>%
#   kbl(table.attr = "style = \"color: black;\"") %>%
#   kable_styling(bootstrap_options = c("striped", "hover"), position = "left",
#                 full_width = F) %>%
#   scroll_box(height = "400px")

# datatable(asha_2020_rep, #playing around with different table options
#           rownames = F,
#           height = "400px",
#           class = "display",
#           extensions = c("Responsive"))
```


#### Senate

```{r}
asha_2020_sen <- read.csv("/Users/brett/Documents/R/PoliticalSpreadsheet/ASHA_PAC/ASHA_2020_candidateSpending_senate.csv")



asha_2020_sen %>% separate(Candidate, 
                           into = c("Name", "ID"), 
                           sep = "\\(",
                           remove = F) %>%
  separate(ID,
           into = c("Party", "State"),
           sep = "\\-") -> asha_2020_sen

#clean up state labels

asha_2020_sen %>%
  mutate(State = case_when(
    State == "Fla)" ~ "FL",
    State == "WVa)" ~ "WV",
    State == "Mass)" ~ "MA",
    State == "NJ)" ~ "NJ",
    State == "Calif)" ~ "CA",
    State == "Texas)" ~ "TX",
    State == "Ky)" ~ "KY",
    State == "Wash)" ~ "WA",
    State == "NC)" ~ "NC",
    State == "Wis)" ~ "WI",
    State == "Ill)" ~ "IL",
    State == "Va)" ~ "VA",
    State == "Pa)" ~ "PA",
    State == "NY)" ~ "NY",
    State == "Del)" ~ "DE",
    State == "Conn)" ~ "CT",
    State == "Ore)" ~ "OR",
    State == "Mich)" ~ "MI",
    State == "Vt)" ~ "VT",
    State == "Ohio)" ~ "OH",
    State == "Colo)" ~ "CO",
    State == "Md)" ~ "MD",
    State == "SC)" ~ "SC",
    State == "LA)" ~ "LA",
    State == "La)" ~ "LA",
    State == "Minn)" ~ "MN",
    State == "Okla)" ~ "OK",
    State == "Mo)" ~ "MO",
    State == "Nev)" ~ "NV",
    State == "Iowa)" ~ "IA",
    State == "Ga)" ~ "GA",
    State == "Ark)" ~ "AR",
    State == "NH)" ~ "NH",
    State == "Ariz)" ~ "AZ",
    State == "Ala)" ~ "AL",
    State == "Neb)" ~ "NE",
    State == "Maine)" ~ "ME",
    State == "Miss)" ~ "MS",
    State == "NM)" ~ "NM",
    
    TRUE ~ State
  )) -> asha_2020_sen

# unique(asha_2020_sen$State)

asha_2020_sen <- asha_2020_sen %>% clean_names()

asha_2020_sen$name <- str_squish(asha_2020_sen$name)

#convert total column to numeric
asha_2020_sen$total <- as.numeric(gsub("\\$", "", asha_2020_sen$total))

```


```{r}
paste("In the 2020 election cycle, ASHA-PAC donated a total of $", sum(asha_2020_sen$total), "to Senators' campaigns.")
```

A list of Senators that ASHA-PAC donated money to for their 2020 campaign.

```{r}
asha_2020_sen %>% 
  select(-candidate) %>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(height = "400px")
```



```{r}
#Change names across DFs so they match
#anti_join(asha_2022_sen, senators, by = "name")

asha_2022_sen <- asha_2022_sen %>%
  mutate(name = case_when(
    name == "Charles E Schumer" ~ "Chuck Schumer",
    name == "John A Barrasso" ~ "John Barrasso",
    TRUE ~ name
  )) %>%
  rename(ASHA_PAC_total = total) %>%
  mutate(year = 2022,
         role = "Senator")

#rename total to ASHA_PAC_total, add role (senator/rep) and year for a single DF

asha_2022_rep <- asha_2022_rep %>% 
  rename(ASHA_PAC_total = total) %>%
  mutate(year = 2022,
         role = "Representative")

asha_2020_rep <- asha_2020_rep %>% 
  rename(ASHA_PAC_total = total) %>%
    mutate(year = 2020,
         role = "Representative")

asha_2020_sen <- asha_2020_sen %>% 
  rename(ASHA_PAC_total = total) %>%
    mutate(year = 2020,
         role = "Senator")

#combine information into a single DF

ashaPAC <- bind_rows(asha_2022_rep, asha_2022_sen, asha_2020_rep, asha_2020_sen)

ashaPAC$name <- str_squish(ashaPAC$name) #get rid of extra spaces

```

### At a Glance FINALIZE

```{r}
ashaPAC %>%
  select(-candidate) %>%
  filter(year == "2020") %>%
  group_by(year, party) %>%
  summarise(total_given = sum(ASHA_PAC_total))
```


```{r}
ashaPAC %>%
  select(-candidate) %>%
  filter(year == "2022") %>%
  group_by(year, party) %>%
  summarise(total_given = sum(ASHA_PAC_total))
```

$169,500 to campaigns in 2022. 

```{r}
ashaPAC %>%
  select(-candidate) %>%
  group_by(year, party, role) %>%
  summarise(total_given = sum(ASHA_PAC_total)) %>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(height = "400px")


#can probably make a prettier table w/ gt() but not urgent

# ashaPAC %>%
#   select(-candidate) %>%
#   group_by(year, party, role) %>%
#   summarise(total_given = sum(ASHA_PAC_total)) %>%
#   gt() 
```



## HRC Scorecard{.tabset}

Data from [HRC's Scorecard on the 117th, 116th, and 115th Congress are available here](https://hrc-prod-requests.s3-us-west-2.amazonaws.com/assets/117th-Congressional-Scorecard_web.cleaned.pdf).

Code used to scrape data

```{r}
#Insert file path to the PDF
hrc <- pdf_text("/Users/brett/Documents/R/PoliticalSpreadsheet/ASHA_PAC/117th-Congressional-Scorecard_web.cleaned.pdf")
```

```{r}

###############################################################
############################ Senate ###########################
###############################################################


################# Page 8 

#Separate information into separate columns
#there are 20 votes taken into account

#hrc[8] 

senators1 <- hrc[8] #extract page from PDF document

senators1 <- strsplit(senators1, "\n") #Separate strings by new lines

senators1 <- senators1[[1]] #Only extract information we want

#senators1

senators1 <- str_squish(senators1) #remove all excess white space

#senators1

#new easier method
senators1 <- as.data.frame(senators1) #transform into DF

senators1 %>% filter(str_detect(senators1, "\\)")) -> senators1 #filter and only keep rows with ) - keeps all rows with political affiliation (R)/(D)

#senators1[1,]

#one row is retained that is not needed - remove
senators1 <- senators1 %>% filter(senators1 != "SENATOR (Party) SCORE SCORE SCORE A B C D E F G H I J K L M N O P Q R S T")

senators1 %>% separate(senators1, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> senators1

#separate votes into different categories
senators1 %>% separate(score1, into = c("score1", "score2", "score3", "score4", 
                                        "vote_tuberville",
                                        "vote_johnLewis",
                                        "vote_filibuster",
                                        "vote_womensHealth",
                                        "vote_saferCommunities",
                                        "vote_lee",
                                        "vote_respectForMarriage",
                                        "vote_buttigieg",
                                        "vote_levine",
                                        "vote_jackson",
                                        "vote_robinson",
                                        "vote_nathan",
                                        "vote_impeachment",
                                        "vote_equalityAct",
                                        "vote_DNHA",
                                        "vote_TFPA",
                                        "vote_SSIA",
                                        "vote_IHRDA",
                                        "vote_ECDFA",
                                        "vote_PrEP"), 
                 sep = " ") -> senators1

senators1 <- senators1 %>% select(-score1, -votes) %>%
  rename(score1 = score2, score2 = score3, score3 = score4)

############ Page 9 w/ newer method

#hrc[9]

senators2 <- hrc[9]

senators2 <- strsplit(senators2, "\n")

senators2 <- senators2[[1]]

#senators2

senators2 <- str_squish(senators2)

#senators2

#new easier method
senators2 <- as.data.frame(senators2)
#filter out rows that do not contain ) 
senators2 %>% filter(str_detect(senators2, "\\)")) -> senators2

#senators2 <- senators2[-1,]
#Filter out first row
senators2 <- senators2 %>% 
  filter(senators2 != "SENATOR (Party) SCORE SCORE SCORE A B C D E F G H I J K L M N O P Q R S T")


senators2 %>% separate(senators2, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> senators2

senators2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", 
                                        "vote_tuberville",
                                        "vote_johnLewis",
                                        "vote_filibuster",
                                        "vote_womensHealth",
                                        "vote_saferCommunities",
                                        "vote_lee",
                                        "vote_respectForMarriage",
                                        "vote_buttigieg",
                                        "vote_levine",
                                        "vote_jackson",
                                        "vote_robinson",
                                        "vote_nathan",
                                        "vote_impeachment",
                                        "vote_equalityAct",
                                        "vote_DNHA",
                                        "vote_TFPA",
                                        "vote_SSIA",
                                        "vote_IHRDA",
                                        "vote_ECDFA",
                                        "vote_PrEP"), 
                 sep = " ") -> senators2

senators2 <- senators2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)


hrc_sen <- bind_rows(senators1, senators2) 

################ Page 10

#hrc[10]

senators2 <- hrc[10]

senators2 <- strsplit(senators2, "\n")

senators2 <- senators2[[1]]

#senators2

senators2 <- str_squish(senators2)

#senators2

#new easier method
senators2 <- as.data.frame(senators2)
#filter out rows that do not contain ) 
senators2 %>% filter(str_detect(senators2, "\\)")) -> senators2

#Chuck Schumer's row becomes misaligned due to the footnotes
#Initial value:
#senators2[13,]
# "I LEVINE Schumer, Charles (D) 3, 4 100 100 100 v v v v v v v v v v v v v v N/A N/A N/A v N/A N/A"

#Changing value to remove the "3, 4"

senators2[13,] <- "I LEVINE Schumer, Charles (D) 100 100 100 v v v v v v v v v v v v v v N/A N/A N/A v N/A N/A"


# Robert Casey Jr.'s row also becomse misaligned due to foot notes
#Initial value:
#senators2[24,]
# "R IHRDA Casey Jr., Robert (D) 5 98 97 97 v v v v v v v v v v v J v v j v v v v v"
# Removing the 5

senators2[24,] <- "R IHRDA Casey Jr., Robert (D) 98 97 97 v v v v v v v v v v v J v v j v v v v v"



#senators2 <- senators2[-1,]
#Filter out first row
senators2 <- senators2 %>% 
  filter(senators2 != "SENATOR (Party) SCORE SCORE SCORE A B C D E F G H I J K L M N O P Q R S T")




senators2 %>% separate(senators2, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> senators2

senators2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", 
                                        "vote_tuberville",
                                        "vote_johnLewis",
                                        "vote_filibuster",
                                        "vote_womensHealth",
                                        "vote_saferCommunities",
                                        "vote_lee",
                                        "vote_respectForMarriage",
                                        "vote_buttigieg",
                                        "vote_levine",
                                        "vote_jackson",
                                        "vote_robinson",
                                        "vote_nathan",
                                        "vote_impeachment",
                                        "vote_equalityAct",
                                        "vote_DNHA",
                                        "vote_TFPA",
                                        "vote_SSIA",
                                        "vote_IHRDA",
                                        "vote_ECDFA",
                                        "vote_PrEP"), 
                 sep = " ") -> senators2

senators2 <- senators2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)


hrc_sen <- bind_rows(hrc_sen, senators2) 

########## Page 11

#hrc[11]

senators2 <- hrc[11]

senators2 <- strsplit(senators2, "\n")

senators2 <- senators2[[1]]

#senators2

senators2 <- str_squish(senators2)

#senators2

#new easier method
senators2 <- as.data.frame(senators2)
#filter out rows that do not contain ) 
senators2 %>% filter(str_detect(senators2, "\\)")) -> senators2

senators2 <- senators2 %>% 
  filter(senators2 != "SENATOR (Party) SCORE SCORE SCORE A B C D E F G H I J K L M N O P Q R S T")




senators2 %>% separate(senators2, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> senators2

senators2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", 
                                        "vote_tuberville",
                                        "vote_johnLewis",
                                        "vote_filibuster",
                                        "vote_womensHealth",
                                        "vote_saferCommunities",
                                        "vote_lee",
                                        "vote_respectForMarriage",
                                        "vote_buttigieg",
                                        "vote_levine",
                                        "vote_jackson",
                                        "vote_robinson",
                                        "vote_nathan",
                                        "vote_impeachment",
                                        "vote_equalityAct",
                                        "vote_DNHA",
                                        "vote_TFPA",
                                        "vote_SSIA",
                                        "vote_IHRDA",
                                        "vote_ECDFA",
                                        "vote_PrEP"), 
                 sep = " ") -> senators2

senators2 <- senators2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)


hrc_sen <- bind_rows(hrc_sen, senators2) 


###############################################################
###################### House of Representatives ###############
###############################################################

############### Page 17

#hrc[17] 

reps1 <- hrc[17] #extract page from PDF document

reps1 <- strsplit(reps1, "\n") #Separate strings by new lines

reps1 <- reps1[[1]] #Only extract information we want

#reps1

reps1 <- str_squish(reps1) #remove all excess white space

#reps1

#new easier method
reps1 <- as.data.frame(reps1) #transform into DF

#Raúl Grijalva's votes not transcribe correctly due to line break
#reps1[21,] = "LESKO AND FOXX/ 3 Grijalva, Raúl (D) 100 100 100"

reps1[21,] <- "LESKO AND FOXX/ 3 Grijalva, Raúl (D) 100 100 100 v v v v v v v v v v v v v v v v v v v v v"

reps1 %>% filter(str_detect(reps1, "\\)")) -> reps1 #filter and only keep rows with ) - keeps all rows with political affiliation (R)/(D)

#reps1[1,]

#one row is retained that is not needed - remove
reps1 <- reps1 %>% filter(reps1 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

reps1 %>% separate(reps1, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> reps1

#separate votes into different categories
reps1 %>% separate(score1, into = c("score1", "score2", "score3", "score4", 
                                    "vote_equalityAct",
                                    "vote_AmericanDream",
                                    "vote_backgroundChecks",
                                    "vote_johnLewis",
                                    "vote_violenceAgainstWomen",
                                    "vote_LGBTQ_BECEIA",
                                    "vote_leskoFoxx",
                                    "vote_womensHealth",
                                    "vote_FVPSA",
                                    "vote_globalRespect",
                                    "vote_LGBTQIdataInclusion",
                                    "vote_saferCommunities",
                                    "vote_RMA_first",
                                    "vote_RMA_final",
                                    "vote_impeachment",
                                    "vote_DNHA",
                                    "vote_TFPA",
                                    "vote_SSIA",
                                    "vote_ECDFA",
                                    "vote_PrEP",
                                    "vote_anti-transDischarge"), 
                 sep = " ") -> reps1


reps1 <- reps1 %>% select(-score1, -votes) %>%
  rename(score1 = score2, score2 = score3, score3 = score4)

hrc_reps <- reps1

############### Page 18

#hrc[18] 

reps1 <- hrc[18] #extract page from PDF document

reps1 <- strsplit(reps1, "\n") #Separate strings by new lines

reps1 <- reps1[[1]] #Only extract information we want

#reps1

reps1 <- str_squish(reps1) #remove all excess white space

#reps1

#new easier method
reps1 <- as.data.frame(reps1) #transform into DF

#### Check and make any changes to lines that were incorrectly transcribed
#reps1[22,] = "LESKO AND FOXX/ 26 Brownley, Julia (D) 100 100 100"

reps1[22,] <- "LESKO AND FOXX/ 26 Brownley, Julia (D) 100 100 100 v v v v v v v v v v v v v v v v v v v v v"


reps1 %>% filter(str_detect(reps1, "\\)")) -> reps1 #filter and only keep rows with ) - keeps all rows with political affiliation (R)/(D)

#reps1[1,]

#one row is retained that is not needed - remove
reps1 <- reps1 %>% filter(reps1 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

reps1 %>% separate(reps1, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> reps1

#separate votes into different categories
reps1 %>% separate(score1, into = c("score1", "score2", "score3", "score4", 
                                    "vote_equalityAct",
                                    "vote_AmericanDream",
                                    "vote_backgroundChecks",
                                    "vote_johnLewis",
                                    "vote_violenceAgainstWomen",
                                    "vote_LGBTQ_BECEIA",
                                    "vote_leskoFoxx",
                                    "vote_womensHealth",
                                    "vote_FVPSA",
                                    "vote_globalRespect",
                                    "vote_LGBTQIdataInclusion",
                                    "vote_saferCommunities",
                                    "vote_RMA_first",
                                    "vote_RMA_final",
                                    "vote_impeachment",
                                    "vote_DNHA",
                                    "vote_TFPA",
                                    "vote_SSIA",
                                    "vote_ECDFA",
                                    "vote_PrEP",
                                    "vote_anti-transDischarge"), 
                 sep = " ") -> reps1


reps1 <- reps1 %>% select(-score1, -votes) %>%
  rename(score1 = score2, score2 = score3, score3 = score4)

#combine
hrc_reps <- bind_rows(hrc_reps, reps1)

############### Page 19

#hrc[19] 

reps1 <- hrc[19] #extract page from PDF document

reps1 <- strsplit(reps1, "\n") #Separate strings by new lines

reps1 <- reps1[[1]] #Only extract information we want

#reps1

reps1 <- str_squish(reps1) #remove all excess white space

#reps1

#new easier method
reps1 <- as.data.frame(reps1) #transform into DF

#### Check and make any changes to lines that were incorrectly transcribed
#reps1[22,] = "LESKO AND FOXX/ 2 Courtney, Joe (D) 100 100 100"

reps1[22,] <- "LESKO AND FOXX/ 2 Courtney, Joe (D) 100 100 100 v v v v v v v v v v v v v v v v v v v v v"


reps1 %>% filter(str_detect(reps1, "\\)")) -> reps1 #filter and only keep rows with ) - keeps all rows with political affiliation (R)/(D)

#reps1[1,]

#one row is retained that is not needed - remove
reps1 <- reps1 %>% filter(reps1 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

reps1 %>% separate(reps1, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> reps1

#separate votes into different categories
reps1 %>% separate(score1, into = c("score1", "score2", "score3", "score4", 
                                    "vote_equalityAct",
                                    "vote_AmericanDream",
                                    "vote_backgroundChecks",
                                    "vote_johnLewis",
                                    "vote_violenceAgainstWomen",
                                    "vote_LGBTQ_BECEIA",
                                    "vote_leskoFoxx",
                                    "vote_womensHealth",
                                    "vote_FVPSA",
                                    "vote_globalRespect",
                                    "vote_LGBTQIdataInclusion",
                                    "vote_saferCommunities",
                                    "vote_RMA_first",
                                    "vote_RMA_final",
                                    "vote_impeachment",
                                    "vote_DNHA",
                                    "vote_TFPA",
                                    "vote_SSIA",
                                    "vote_ECDFA",
                                    "vote_PrEP",
                                    "vote_anti-transDischarge"), 
                 sep = " ") -> reps1


reps1 <- reps1 %>% select(-score1, -votes) %>%
  rename(score1 = score2, score2 = score3, score3 = score4)

#combine
hrc_reps <- bind_rows(hrc_reps, reps1)

############### Page 20

#hrc[20] 

reps1 <- hrc[20] #extract page from PDF document

reps1 <- strsplit(reps1, "\n") #Separate strings by new lines

reps1 <- reps1[[1]] #Only extract information we want

#reps1

reps1 <- str_squish(reps1) #remove all excess white space

#reps1

#new easier method
reps1 <- as.data.frame(reps1) #transform into DF

#### Check and make any changes to lines that were incorrectly transcribed
#reps1[22,] = "LESKO AND FOXX/ 4 Johnson Jr., Henry “Hank” (D) 100 100 100"

reps1[22,] <- "LESKO AND FOXX/ 4 Johnson Jr., Henry “Hank” (D) 100 100 100 v v v v v v v v v v v v v v v v v v v v v"


reps1 %>% filter(str_detect(reps1, "\\)")) -> reps1 #filter and only keep rows with ) - keeps all rows with political affiliation (R)/(D)

#reps1[1,]

#one row is retained that is not needed - remove
reps1 <- reps1 %>% filter(reps1 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

reps1 %>% separate(reps1, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> reps1

#separate votes into different categories
reps1 %>% separate(score1, into = c("score1", "score2", "score3", "score4", 
                                    "vote_equalityAct",
                                    "vote_AmericanDream",
                                    "vote_backgroundChecks",
                                    "vote_johnLewis",
                                    "vote_violenceAgainstWomen",
                                    "vote_LGBTQ_BECEIA",
                                    "vote_leskoFoxx",
                                    "vote_womensHealth",
                                    "vote_FVPSA",
                                    "vote_globalRespect",
                                    "vote_LGBTQIdataInclusion",
                                    "vote_saferCommunities",
                                    "vote_RMA_first",
                                    "vote_RMA_final",
                                    "vote_impeachment",
                                    "vote_DNHA",
                                    "vote_TFPA",
                                    "vote_SSIA",
                                    "vote_ECDFA",
                                    "vote_PrEP",
                                    "vote_anti-transDischarge"), 
                 sep = " ") -> reps1


reps1 <- reps1 %>% select(-score1, -votes) %>%
  rename(score1 = score2, score2 = score3, score3 = score4)

#combine
hrc_reps <- bind_rows(hrc_reps, reps1)


############### Page 21

#hrc[21] 

reps1 <- hrc[21] #extract page from PDF document

reps1 <- strsplit(reps1, "\n") #Separate strings by new lines

reps1 <- reps1[[1]] #Only extract information we want

#reps1

reps1 <- str_squish(reps1) #remove all excess white space

#reps1

#new easier method
reps1 <- as.data.frame(reps1) #transform into DF

#### Check and make any changes to lines that were incorrectly transcribed
#reps1[22,] = "LESKO AND FOXX/ 2 Yakym, Rudy (R)9 N/A N/A N/A N/A N/A N/A N/A N/A N/A N/A N/A N/A N/A N/A N/A N/A N/A"

reps1[22,] <- "LESKO AND FOXX/ 2 Yakym, Rudy (R)9 N/A N/A N/A N/A N/A N/A N/A N/A N/A N/A N/A N/A N/A N/A N/A N/A j N/A j j j j j v"


reps1 %>% filter(str_detect(reps1, "\\)")) -> reps1 #filter and only keep rows with ) - keeps all rows with political affiliation (R)/(D)

#reps1[1,]

#one row is retained that is not needed - remove
reps1 <- reps1 %>% filter(reps1 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

reps1 %>% separate(reps1, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> reps1

#separate votes into different categories
reps1 %>% separate(score1, into = c("score1", "score2", "score3", "score4", 
                                    "vote_equalityAct",
                                    "vote_AmericanDream",
                                    "vote_backgroundChecks",
                                    "vote_johnLewis",
                                    "vote_violenceAgainstWomen",
                                    "vote_LGBTQ_BECEIA",
                                    "vote_leskoFoxx",
                                    "vote_womensHealth",
                                    "vote_FVPSA",
                                    "vote_globalRespect",
                                    "vote_LGBTQIdataInclusion",
                                    "vote_saferCommunities",
                                    "vote_RMA_first",
                                    "vote_RMA_final",
                                    "vote_impeachment",
                                    "vote_DNHA",
                                    "vote_TFPA",
                                    "vote_SSIA",
                                    "vote_ECDFA",
                                    "vote_PrEP",
                                    "vote_anti-transDischarge"), 
                 sep = " ") -> reps1


reps1 <- reps1 %>% select(-score1, -votes) %>%
  rename(score1 = score2, score2 = score3, score3 = score4)

#combine
hrc_reps <- bind_rows(hrc_reps, reps1)


############### Page 22

#hrc[22] 

reps1 <- hrc[22] #extract page from PDF document

reps1 <- strsplit(reps1, "\n") #Separate strings by new lines

reps1 <- reps1[[1]] #Only extract information we want

#reps1

reps1 <- str_squish(reps1) #remove all excess white space

#reps1

#new easier method
reps1 <- as.data.frame(reps1) #transform into DF

#### Check and make any changes to lines that were incorrectly transcribed

#No known issues with this page
# 
# 
reps1 %>% filter(str_detect(reps1, "\\)")) -> reps1 #filter and only keep rows with ) - keeps all rows with political affiliation (R)/(D)

#reps1[1,]

#one row is retained that is not needed - remove
reps1 <- reps1 %>% filter(reps1 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

reps1 %>% separate(reps1, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> reps1

#separate votes into different categories
reps1 %>% separate(score1, into = c("score1", "score2", "score3", "score4", 
                                    "vote_equalityAct",
                                    "vote_AmericanDream",
                                    "vote_backgroundChecks",
                                    "vote_johnLewis",
                                    "vote_violenceAgainstWomen",
                                    "vote_LGBTQ_BECEIA",
                                    "vote_leskoFoxx",
                                    "vote_womensHealth",
                                    "vote_FVPSA",
                                    "vote_globalRespect",
                                    "vote_LGBTQIdataInclusion",
                                    "vote_saferCommunities",
                                    "vote_RMA_first",
                                    "vote_RMA_final",
                                    "vote_impeachment",
                                    "vote_DNHA",
                                    "vote_TFPA",
                                    "vote_SSIA",
                                    "vote_ECDFA",
                                    "vote_PrEP",
                                    "vote_anti-transDischarge"), 
                 sep = " ") -> reps1


reps1 <- reps1 %>% select(-score1, -votes) %>%
  rename(score1 = score2, score2 = score3, score3 = score4)

#combine
hrc_reps <- bind_rows(hrc_reps, reps1)

############### Page 23

#hrc[23] 

reps1 <- hrc[23] #extract page from PDF document

reps1 <- strsplit(reps1, "\n") #Separate strings by new lines

reps1 <- reps1[[1]] #Only extract information we want

#reps1

reps1 <- str_squish(reps1) #remove all excess white space

#reps1

#new easier method
reps1 <- as.data.frame(reps1) #transform into DF

#### Check and make any changes to lines that were incorrectly transcribed
#reps1[22,] = "LESKO AND FOXX/ 6 Emmer, Tom (R) 14 0 0"

reps1[22,] <- "LESKO AND FOXX/ 6 Emmer, Tom (R) 14 0 0 j j j j j v j j j j j j v v j j j j j j j"


# 
# 
reps1 %>% filter(str_detect(reps1, "\\)")) -> reps1 #filter and only keep rows with ) - keeps all rows with political affiliation (R)/(D)

#reps1[1,]

#one row is retained that is not needed - remove
reps1 <- reps1 %>% filter(reps1 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

reps1 %>% separate(reps1, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> reps1

#separate votes into different categories
reps1 %>% separate(score1, into = c("score1", "score2", "score3", "score4", 
                                    "vote_equalityAct",
                                    "vote_AmericanDream",
                                    "vote_backgroundChecks",
                                    "vote_johnLewis",
                                    "vote_violenceAgainstWomen",
                                    "vote_LGBTQ_BECEIA",
                                    "vote_leskoFoxx",
                                    "vote_womensHealth",
                                    "vote_FVPSA",
                                    "vote_globalRespect",
                                    "vote_LGBTQIdataInclusion",
                                    "vote_saferCommunities",
                                    "vote_RMA_first",
                                    "vote_RMA_final",
                                    "vote_impeachment",
                                    "vote_DNHA",
                                    "vote_TFPA",
                                    "vote_SSIA",
                                    "vote_ECDFA",
                                    "vote_PrEP",
                                    "vote_anti-transDischarge"), 
                 sep = " ") -> reps1


reps1 <- reps1 %>% select(-score1, -votes) %>%
  rename(score1 = score2, score2 = score3, score3 = score4)

#combine
hrc_reps <- bind_rows(hrc_reps, reps1)


############### Page 24

#hrc[24] 

reps1 <- hrc[24] #extract page from PDF document

reps1 <- strsplit(reps1, "\n") #Separate strings by new lines

reps1 <- reps1[[1]] #Only extract information we want

#reps1

reps1 <- str_squish(reps1) #remove all excess white space

#reps1

#new easier method
reps1 <- as.data.frame(reps1) #transform into DF

#### Check and make any changes to lines that were incorrectly transcribed
#reps1[22,] = "LESKO AND FOXX/ 5 Gottheimer, Josh (D) 100 100 100"

reps1[22,] <- "LESKO AND FOXX/ 5 Gottheimer, Josh (D) 100 100 100 v v v v v v v v v v v v v v v v v v v v v"


# 
# 
reps1 %>% filter(str_detect(reps1, "\\)")) -> reps1 #filter and only keep rows with ) - keeps all rows with political affiliation (R)/(D)

#reps1[1,]

#one row is retained that is not needed - remove
reps1 <- reps1 %>% filter(reps1 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

reps1 %>% separate(reps1, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> reps1

#separate votes into different categories
reps1 %>% separate(score1, into = c("score1", "score2", "score3", "score4", 
                                    "vote_equalityAct",
                                    "vote_AmericanDream",
                                    "vote_backgroundChecks",
                                    "vote_johnLewis",
                                    "vote_violenceAgainstWomen",
                                    "vote_LGBTQ_BECEIA",
                                    "vote_leskoFoxx",
                                    "vote_womensHealth",
                                    "vote_FVPSA",
                                    "vote_globalRespect",
                                    "vote_LGBTQIdataInclusion",
                                    "vote_saferCommunities",
                                    "vote_RMA_first",
                                    "vote_RMA_final",
                                    "vote_impeachment",
                                    "vote_DNHA",
                                    "vote_TFPA",
                                    "vote_SSIA",
                                    "vote_ECDFA",
                                    "vote_PrEP",
                                    "vote_anti-transDischarge"), 
                 sep = " ") -> reps1


reps1 <- reps1 %>% select(-score1, -votes) %>%
  rename(score1 = score2, score2 = score3, score3 = score4)

#combine
hrc_reps <- bind_rows(hrc_reps, reps1)


############### Page 25

#hrc[25] 

reps1 <- hrc[25] #extract page from PDF document

reps1 <- strsplit(reps1, "\n") #Separate strings by new lines

reps1 <- reps1[[1]] #Only extract information we want

#reps1

reps1 <- str_squish(reps1) #remove all excess white space

#reps1

#new easier method
reps1 <- as.data.frame(reps1) #transform into DF

#### Check and make any changes to lines that were incorrectly transcribed
#reps1[22,] = "LESKO AND FOXX/ 24 Katko, John (R) 68 54 61"

reps1[22,] <- "LESKO AND FOXX/ 24 Katko, John (R) 68 54 61 v j j j v v v j v v v v v v v j j v j j v"


# 
# 
reps1 %>% filter(str_detect(reps1, "\\)")) -> reps1 #filter and only keep rows with ) - keeps all rows with political affiliation (R)/(D)

#reps1[1,]

#one row is retained that is not needed - remove
reps1 <- reps1 %>% filter(reps1 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

reps1 %>% separate(reps1, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> reps1

#separate votes into different categories
reps1 %>% separate(score1, into = c("score1", "score2", "score3", "score4", 
                                    "vote_equalityAct",
                                    "vote_AmericanDream",
                                    "vote_backgroundChecks",
                                    "vote_johnLewis",
                                    "vote_violenceAgainstWomen",
                                    "vote_LGBTQ_BECEIA",
                                    "vote_leskoFoxx",
                                    "vote_womensHealth",
                                    "vote_FVPSA",
                                    "vote_globalRespect",
                                    "vote_LGBTQIdataInclusion",
                                    "vote_saferCommunities",
                                    "vote_RMA_first",
                                    "vote_RMA_final",
                                    "vote_impeachment",
                                    "vote_DNHA",
                                    "vote_TFPA",
                                    "vote_SSIA",
                                    "vote_ECDFA",
                                    "vote_PrEP",
                                    "vote_anti-transDischarge"), 
                 sep = " ") -> reps1


reps1 <- reps1 %>% select(-score1, -votes) %>%
  rename(score1 = score2, score2 = score3, score3 = score4)

#combine
hrc_reps <- bind_rows(hrc_reps, reps1)


############### Page 26

#hrc[26] 

reps1 <- hrc[26] #extract page from PDF document

reps1 <- strsplit(reps1, "\n") #Separate strings by new lines

reps1 <- reps1[[1]] #Only extract information we want

#reps1

reps1 <- str_squish(reps1) #remove all excess white space

#reps1

#new easier method
reps1 <- as.data.frame(reps1) #transform into DF

#### Check and make any changes to lines that were incorrectly transcribed
#reps1[22,] = "LESKO AND FOXX/ 13 Ryan, Tim (D) 100 100 100"

reps1[22,] <- "LESKO AND FOXX/ 13 Ryan, Tim (D) 100 100 100 v v v v v v v v v v v v v v v v v v v v v"


# 
# 
reps1 %>% filter(str_detect(reps1, "\\)")) -> reps1 #filter and only keep rows with ) - keeps all rows with political affiliation (R)/(D)

#reps1[1,]

#one row is retained that is not needed - remove
reps1 <- reps1 %>% filter(reps1 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

reps1 %>% separate(reps1, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> reps1

#separate votes into different categories
reps1 %>% separate(score1, into = c("score1", "score2", "score3", "score4", 
                                    "vote_equalityAct",
                                    "vote_AmericanDream",
                                    "vote_backgroundChecks",
                                    "vote_johnLewis",
                                    "vote_violenceAgainstWomen",
                                    "vote_LGBTQ_BECEIA",
                                    "vote_leskoFoxx",
                                    "vote_womensHealth",
                                    "vote_FVPSA",
                                    "vote_globalRespect",
                                    "vote_LGBTQIdataInclusion",
                                    "vote_saferCommunities",
                                    "vote_RMA_first",
                                    "vote_RMA_final",
                                    "vote_impeachment",
                                    "vote_DNHA",
                                    "vote_TFPA",
                                    "vote_SSIA",
                                    "vote_ECDFA",
                                    "vote_PrEP",
                                    "vote_anti-transDischarge"), 
                 sep = " ") -> reps1


reps1 <- reps1 %>% select(-score1, -votes) %>%
  rename(score1 = score2, score2 = score3, score3 = score4)

#combine
hrc_reps <- bind_rows(hrc_reps, reps1)


############### Page 27

#hrc[27] 

reps1 <- hrc[27] #extract page from PDF document

reps1 <- strsplit(reps1, "\n") #Separate strings by new lines

reps1 <- reps1[[1]] #Only extract information we want

#reps1

reps1 <- str_squish(reps1) #remove all excess white space

#reps1

#new easier method
reps1 <- as.data.frame(reps1) #transform into DF

#### Check and make any changes to lines that were incorrectly transcribed
#reps1[21,] = "LESKO AND FOXX/ 1 Cicilline, David (D) 100 100 100"

reps1[21,] <- "LESKO AND FOXX/ 1 Cicilline, David (D) 100 100 100 v v v v v v v v v v v v v v v v v v v v v"


# 
# 
reps1 %>% filter(str_detect(reps1, "\\)")) -> reps1 #filter and only keep rows with ) - keeps all rows with political affiliation (R)/(D)

#reps1[1,]

#one row is retained that is not needed - remove
reps1 <- reps1 %>% filter(reps1 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

reps1 %>% separate(reps1, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> reps1

#separate votes into different categories
reps1 %>% separate(score1, into = c("score1", "score2", "score3", "score4", 
                                    "vote_equalityAct",
                                    "vote_AmericanDream",
                                    "vote_backgroundChecks",
                                    "vote_johnLewis",
                                    "vote_violenceAgainstWomen",
                                    "vote_LGBTQ_BECEIA",
                                    "vote_leskoFoxx",
                                    "vote_womensHealth",
                                    "vote_FVPSA",
                                    "vote_globalRespect",
                                    "vote_LGBTQIdataInclusion",
                                    "vote_saferCommunities",
                                    "vote_RMA_first",
                                    "vote_RMA_final",
                                    "vote_impeachment",
                                    "vote_DNHA",
                                    "vote_TFPA",
                                    "vote_SSIA",
                                    "vote_ECDFA",
                                    "vote_PrEP",
                                    "vote_anti-transDischarge"), 
                 sep = " ") -> reps1


reps1 <- reps1 %>% select(-score1, -votes) %>%
  rename(score1 = score2, score2 = score3, score3 = score4)

#combine
hrc_reps <- bind_rows(hrc_reps, reps1)


############### Page 28

#hrc[28] 

reps1 <- hrc[28] #extract page from PDF document

reps1 <- strsplit(reps1, "\n") #Separate strings by new lines

reps1 <- reps1[[1]] #Only extract information we want

#reps1

reps1 <- str_squish(reps1) #remove all excess white space

#reps1

#new easier method
reps1 <- as.data.frame(reps1) #transform into DF

#### Check and make any changes to lines that were incorrectly transcribed
#reps1[22,] = "LESKO AND FOXX/ 13 Jackson, Ronny (R) 0 N/A N/A"

reps1[22,] <- "LESKO AND FOXX/ 13 Jackson, Ronny (R) 0 N/A N/A j j j j j j j j j j j j j j j j j j j j j"

# 
# 
reps1 %>% filter(str_detect(reps1, "\\)")) -> reps1 #filter and only keep rows with ) - keeps all rows with political affiliation (R)/(D)

#reps1[1,]

#one row is retained that is not needed - remove
reps1 <- reps1 %>% filter(reps1 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

reps1 %>% separate(reps1, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> reps1

#separate votes into different categories
reps1 %>% separate(score1, into = c("score1", "score2", "score3", "score4", 
                                    "vote_equalityAct",
                                    "vote_AmericanDream",
                                    "vote_backgroundChecks",
                                    "vote_johnLewis",
                                    "vote_violenceAgainstWomen",
                                    "vote_LGBTQ_BECEIA",
                                    "vote_leskoFoxx",
                                    "vote_womensHealth",
                                    "vote_FVPSA",
                                    "vote_globalRespect",
                                    "vote_LGBTQIdataInclusion",
                                    "vote_saferCommunities",
                                    "vote_RMA_first",
                                    "vote_RMA_final",
                                    "vote_impeachment",
                                    "vote_DNHA",
                                    "vote_TFPA",
                                    "vote_SSIA",
                                    "vote_ECDFA",
                                    "vote_PrEP",
                                    "vote_anti-transDischarge"), 
                 sep = " ") -> reps1


reps1 <- reps1 %>% select(-score1, -votes) %>%
  rename(score1 = score2, score2 = score3, score3 = score4)

#combine
hrc_reps <- bind_rows(hrc_reps, reps1)

############### Page 29

#hrc[29] 

reps1 <- hrc[29] #extract page from PDF document

reps1 <- strsplit(reps1, "\n") #Separate strings by new lines

reps1 <- reps1[[1]] #Only extract information we want

#reps1

reps1 <- str_squish(reps1) #remove all excess white space

#reps1

#new easier method
reps1 <- as.data.frame(reps1) #transform into DF

#### Check and make any changes to lines that were incorrectly transcribed
#reps1[22,] = "LESKO AND FOXX/ 6 Cline, Ben (R) 0 0 N/A"

reps1[22,] <- "LESKO AND FOXX/ 6 Cline, Ben (R) 0 0 N/A j j j j j j j j j j j j j j j j j j j j j"

# 
# 
reps1 %>% filter(str_detect(reps1, "\\)")) -> reps1 #filter and only keep rows with ) - keeps all rows with political affiliation (R)/(D)

#reps1[1,]

#one row is retained that is not needed - remove
reps1 <- reps1 %>% filter(reps1 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

reps1 %>% separate(reps1, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> reps1

#separate votes into different categories
reps1 %>% separate(score1, into = c("score1", "score2", "score3", "score4", 
                                    "vote_equalityAct",
                                    "vote_AmericanDream",
                                    "vote_backgroundChecks",
                                    "vote_johnLewis",
                                    "vote_violenceAgainstWomen",
                                    "vote_LGBTQ_BECEIA",
                                    "vote_leskoFoxx",
                                    "vote_womensHealth",
                                    "vote_FVPSA",
                                    "vote_globalRespect",
                                    "vote_LGBTQIdataInclusion",
                                    "vote_saferCommunities",
                                    "vote_RMA_first",
                                    "vote_RMA_final",
                                    "vote_impeachment",
                                    "vote_DNHA",
                                    "vote_TFPA",
                                    "vote_SSIA",
                                    "vote_ECDFA",
                                    "vote_PrEP",
                                    "vote_anti-transDischarge"), 
                 sep = " ") -> reps1


reps1 <- reps1 %>% select(-score1, -votes) %>%
  rename(score1 = score2, score2 = score3, score3 = score4)

#combine
hrc_reps <- bind_rows(hrc_reps, reps1)


############### Page 30

#hrc[30] 

reps1 <- hrc[30] #extract page from PDF document

reps1 <- strsplit(reps1, "\n") #Separate strings by new lines

reps1 <- reps1[[1]] #Only extract information we want

#reps1

reps1 <- str_squish(reps1) #remove all excess white space
#Removing the extra white space reduces the votes for the Delegates from the territories 

#reps1

#new easier method
reps1 <- as.data.frame(reps1) #transform into DF

#### Check and make any changes to lines that were incorrectly transcribed
#reps1[22,] = "LESKO AND FOXX/ 6 Cline, Ben (R) 0 0 N/A"

# reps1[22,] <- "LESKO AND FOXX/ 6 Cline, Ben (R) 0 0 N/A j j j j j j j j j j j j j j j j j j j j j"

# 
# 
reps1 %>% filter(str_detect(reps1, "\\)")) -> reps1 #filter and only keep rows with ) - keeps all rows with political affiliation (R)/(D)

#reps1[1,]

#one row is retained that is not needed - remove
reps1 <- reps1 %>% filter(reps1 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

reps1 %>% separate(reps1, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> reps1

#separate votes into different categories
reps1 %>% separate(score1, into = c("score1", "score2", "score3", "score4", 
                                    "vote_equalityAct",
                                    "vote_AmericanDream",
                                    "vote_backgroundChecks",
                                    "vote_johnLewis",
                                    "vote_violenceAgainstWomen",
                                    "vote_LGBTQ_BECEIA",
                                    "vote_leskoFoxx",
                                    "vote_womensHealth",
                                    "vote_FVPSA",
                                    "vote_globalRespect",
                                    "vote_LGBTQIdataInclusion",
                                    "vote_saferCommunities",
                                    "vote_RMA_first",
                                    "vote_RMA_final",
                                    "vote_impeachment",
                                    "vote_DNHA",
                                    "vote_TFPA",
                                    "vote_SSIA",
                                    "vote_ECDFA",
                                    "vote_PrEP",
                                    "vote_anti-transDischarge"), 
                 sep = " ") -> reps1


reps1 <- reps1 %>% select(-score1, -votes) %>%
  rename(score1 = score2, score2 = score3, score3 = score4)

#Fix the voting records for Territory Delegates

reps1 <- reps1 %>%
  mutate(vote_equalityAct = case_when( #change values to NA for Equality Act
    name == "AL Amata Coleman (R" ~ NA_character_,
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ NA_character_,
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ NA_character_,
    name == "Q TFPA AL Sablan, Gregorio (D" ~ NA_character_,
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ NA_character_,
    name == "AL Plaskett, Stacey (D" ~ NA_character_,
    TRUE ~ vote_equalityAct
  ),
  #American Dream
  vote_AmericanDream = case_when(
    name == "AL Amata Coleman (R" ~ NA_character_,
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ NA_character_,
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ NA_character_,
    name == "Q TFPA AL Sablan, Gregorio (D" ~ NA_character_,
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ NA_character_,
    name == "AL Plaskett, Stacey (D" ~ NA_character_,
    TRUE ~ vote_AmericanDream
  ),
  #Background checks
  vote_backgroundChecks = case_when(
    name == "AL Amata Coleman (R" ~ NA_character_,
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ NA_character_,
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ NA_character_,
    name == "Q TFPA AL Sablan, Gregorio (D" ~ NA_character_,
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ NA_character_,
    name == "AL Plaskett, Stacey (D" ~ NA_character_,
    TRUE ~ vote_backgroundChecks
  ),
  #vote John Lewis
  vote_johnLewis = case_when(
    name == "AL Amata Coleman (R" ~ NA_character_,
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ NA_character_,
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ NA_character_,
    name == "Q TFPA AL Sablan, Gregorio (D" ~ NA_character_,
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ NA_character_,
    name == "AL Plaskett, Stacey (D" ~ NA_character_,
    TRUE ~ vote_johnLewis
  ),
  #violence against women
  vote_violenceAgainstWomen = case_when(
    name == "AL Amata Coleman (R" ~ NA_character_,
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ NA_character_,
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ NA_character_,
    name == "Q TFPA AL Sablan, Gregorio (D" ~ NA_character_,
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ NA_character_,
    name == "AL Plaskett, Stacey (D" ~ NA_character_,
    TRUE ~ vote_violenceAgainstWomen
  ),
  #LGBTQIA BECEIA
  vote_LGBTQ_BECEIA = case_when(
    name == "AL Amata Coleman (R" ~ NA_character_,
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ NA_character_,
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ NA_character_,
    name == "Q TFPA AL Sablan, Gregorio (D" ~ NA_character_,
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ NA_character_,
    name == "AL Plaskett, Stacey (D" ~ NA_character_,
    TRUE ~ vote_LGBTQ_BECEIA
  ),
  #Lesko Foxx
  vote_leskoFoxx = case_when(
    name == "AL Amata Coleman (R" ~ NA_character_,
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ NA_character_,
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ NA_character_,
    name == "Q TFPA AL Sablan, Gregorio (D" ~ NA_character_,
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ NA_character_,
    name == "AL Plaskett, Stacey (D" ~ NA_character_,
    TRUE ~ vote_leskoFoxx
  ),
  #women's health
  vote_womensHealth = case_when(
    name == "AL Amata Coleman (R" ~ NA_character_,
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ NA_character_,
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ NA_character_,
    name == "Q TFPA AL Sablan, Gregorio (D" ~ NA_character_,
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ NA_character_,
    name == "AL Plaskett, Stacey (D" ~ NA_character_,
    TRUE ~ vote_womensHealth
  ),
  #FVPSA
  vote_FVPSA = case_when(
    name == "AL Amata Coleman (R" ~ NA_character_,
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ NA_character_,
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ NA_character_,
    name == "Q TFPA AL Sablan, Gregorio (D" ~ NA_character_,
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ NA_character_,
    name == "AL Plaskett, Stacey (D" ~ NA_character_,
    TRUE ~ vote_FVPSA
  ),
  #Global Respect
  vote_globalRespect = case_when(
    name == "AL Amata Coleman (R" ~ NA_character_,
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ NA_character_,
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ NA_character_,
    name == "Q TFPA AL Sablan, Gregorio (D" ~ NA_character_,
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ NA_character_,
    name == "AL Plaskett, Stacey (D" ~ NA_character_,
    TRUE ~ vote_globalRespect
  ),
  #LGBTQIA Data Inclusion
  vote_LGBTQIdataInclusion = case_when(
    name == "AL Amata Coleman (R" ~ NA_character_,
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ NA_character_,
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ NA_character_,
    name == "Q TFPA AL Sablan, Gregorio (D" ~ NA_character_,
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ NA_character_,
    name == "AL Plaskett, Stacey (D" ~ NA_character_,
    TRUE ~ vote_LGBTQIdataInclusion
  ),
  #Safter Communities
  vote_saferCommunities = case_when(
    name == "AL Amata Coleman (R" ~ NA_character_,
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ NA_character_,
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ NA_character_,
    name == "Q TFPA AL Sablan, Gregorio (D" ~ NA_character_,
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ NA_character_,
    name == "AL Plaskett, Stacey (D" ~ NA_character_,
    TRUE ~ vote_saferCommunities
  ),
  #RMA first
  vote_RMA_first = case_when(
    name == "AL Amata Coleman (R" ~ NA_character_,
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ NA_character_,
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ NA_character_,
    name == "Q TFPA AL Sablan, Gregorio (D" ~ NA_character_,
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ NA_character_,
    name == "AL Plaskett, Stacey (D" ~ NA_character_,
    TRUE ~ vote_RMA_first
  ),
  #RMA Final
  vote_RMA_final = case_when(
    name == "AL Amata Coleman (R" ~ NA_character_,
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ NA_character_,
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ NA_character_,
    name == "Q TFPA AL Sablan, Gregorio (D" ~ NA_character_,
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ NA_character_,
    name == "AL Plaskett, Stacey (D" ~ NA_character_,
    TRUE ~ vote_RMA_final
  ),
  #Impeachment
  vote_impeachment = case_when(
    name == "AL Amata Coleman (R" ~ NA_character_,
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ NA_character_,
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ NA_character_,
    name == "Q TFPA AL Sablan, Gregorio (D" ~ NA_character_,
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ NA_character_,
    name == "AL Plaskett, Stacey (D" ~ NA_character_,
    TRUE ~ vote_impeachment
  ),
  #DNHA
  vote_DNHA = case_when(
    name == "AL Amata Coleman (R" ~ "j",
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ "v",
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ "j",
    name == "Q TFPA AL Sablan, Gregorio (D" ~ "v",
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ "j",
    name == "AL Plaskett, Stacey (D" ~ "j",
    TRUE ~ vote_DNHA
  ),
  #TFPA
  vote_TFPA = case_when(
    name == "AL Amata Coleman (R" ~ "j",
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ "v",
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ "j",
    name == "Q TFPA AL Sablan, Gregorio (D" ~ "v",
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ "j",
    name == "AL Plaskett, Stacey (D" ~ "j",
    TRUE ~ vote_TFPA
  ),
  #SSIA
  vote_SSIA = case_when(
    name == "AL Amata Coleman (R" ~ "j",
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ "v",
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ "v",
    name == "Q TFPA AL Sablan, Gregorio (D" ~ "j",
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ "j",
    name == "AL Plaskett, Stacey (D" ~ "j",
    TRUE ~ vote_SSIA
  ),
  #ECDFA
  vote_ECDFA = case_when(
    name == "AL Amata Coleman (R" ~ "j",
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ "v",
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ "v",
    name == "Q TFPA AL Sablan, Gregorio (D" ~ "v",
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ "v",
    name == "AL Plaskett, Stacey (D" ~ "v",
    TRUE ~ vote_ECDFA
  ),
  #PrEP Access
  vote_PrEP = case_when(
    name == "AL Amata Coleman (R" ~ "j",
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ "v",
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ "v",
    name == "Q TFPA AL Sablan, Gregorio (D" ~ "v",
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ "j",
    name == "AL Plaskett, Stacey (D" ~ "j",
    TRUE ~ vote_PrEP
  ),
  #Anti-trans discharge
  `vote_anti-transDischarge` = case_when(
    name == "AL Amata Coleman (R" ~ NA_character_,
    name == "O IMPEACHMENT AL Norton, Eleanor Holmes (D" ~ NA_character_,
    name == "P DNHA AL San Nicolas, Michael F.Q. (D" ~ NA_character_,
    name == "Q TFPA AL Sablan, Gregorio (D" ~ NA_character_,
    name == "R SSIA AL González-Colón, Jenniffer (R" ~ NA_character_,
    name == "AL Plaskett, Stacey (D" ~ NA_character_,
    TRUE ~ `vote_anti-transDischarge`
  ))


#combine
hrc_reps <- bind_rows(hrc_reps, reps1)


```



Here are the members of the 117th Congress and their HRC scores on equality.



### Representatives

```{r}
hrc_reps <- hrc_reps %>%
  rename(score_117 = score1,
         score_116 = score2,
         score_115 = score3)

#CHANGE THE CHARACTERS RE VOTING

hrc_reps %>% mutate_at(vars(5:25),
                            funs(case_when(
  . == "j" ~ "anti-HRC",
  . =="v" ~ "pro-HRC",
  . == "J" ~ "did not vote",
  . == "P" ~ "voted present",
  TRUE ~ .
))) -> hrc_reps



#clean up names

hrc_reps %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5",
                          "spot6", "spot7","spot8","spot9","spot10"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot2, "\\,")) %>%
  select(-spot1, -spot4:-spot10 )%>%
  rename(last_name = spot2, first_name = spot3) -> hrc_rep_df


hrc_reps %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5",
                          "spot6", "spot7","spot8","spot9","spot10"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot3, "\\,")) %>%
  select(-spot1) %>%
  mutate(spot2 = case_when(
    spot2 == "13" ~ NA_character_,
    spot2 == "51" ~ NA_character_,
    spot2 == "19" ~ NA_character_,
    spot2 == "8" ~ NA_character_,
    spot2 == "11" ~ NA_character_,
    spot2 == "7" ~ NA_character_,
    TRUE ~ spot2
  )) %>%
  unite("last_name", spot2, spot3, sep = " ", na.rm= T) %>%
  rename(first_name = spot4) %>%
  select(-spot5:-spot10) -> hrc_rep_df2
  
hrc_rep_df <- bind_rows(hrc_rep_df, hrc_rep_df2)


hrc_reps %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5",
                          "spot6", "spot7","spot8","spot9","spot10"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot4, "\\,")) %>%
  select(-spot1:-spot3) %>%
  rename(last_name = spot4) %>%
  unite("first_name", spot5, spot6, sep = " ", na.rm = T) %>%
  select(-spot7:-spot10) -> hrc_rep_df2

hrc_rep_df <- bind_rows(hrc_rep_df, hrc_rep_df2)

hrc_reps %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5",
                          "spot6", "spot7","spot8","spot9","spot10"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot5, "\\,")) %>%
  select(-spot1:-spot3) %>%
  mutate(spot4 = case_when(
    spot4 %in% c("1","2","3","4","5","6","9","10","12","13","14","15","24",
                 "26", "34", "36", "53", "21", "23") ~ NA_character_,
    TRUE ~ spot4
  )) %>%
  unite("last_name", spot4, spot5, sep = " ", na.rm = T) %>%
  rename(first_name = spot6) %>%
  select(-spot7:-spot10) -> hrc_rep_df2

hrc_rep_df <- bind_rows(hrc_rep_df, hrc_rep_df2)


hrc_reps %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5",
                          "spot6", "spot7","spot8","spot9","spot10"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot6, "\\,")) %>%
  select(-spot1:-spot4) %>%
  mutate(spot5 = case_when(
    spot5 %in% c("1","2","3","4","5","6","9","10","12","13","14","15","24",
                 "26","34","36","53","21","23","11","17","AL","25","19",
                 "37", "39","7") ~ NA_character_,
    TRUE ~ spot5
  )) %>%
  unite("last_name", spot5, spot6, sep = " ", na.rm = T) %>%
  rename(first_name = spot7) %>%
  select(-spot8:-spot10) -> hrc_rep_df2

hrc_rep_df <- bind_rows(hrc_rep_df, hrc_rep_df2)

hrc_reps %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5",
                          "spot6", "spot7","spot8","spot9","spot10"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot7, "\\,")) %>%
  select(-spot1:-spot5) %>%
  unite("last_name", spot6, spot7, sep = " ") %>%
  select(-spot9:-spot10)%>%
  rename(first_name = spot8) -> hrc_rep_df2

hrc_rep_df <- bind_rows(hrc_rep_df, hrc_rep_df2)

hrc_rep_df %>% unite("name", first_name, last_name, sep = " ", remove = F) %>%
  mutate(name = str_replace(name, "[[:punct:]]", "")) -> hrc_rep_df

#clean up the names and remove additional spaces
hrc_rep_df$name <- str_squish(hrc_rep_df$name)

#Change columns to numeric and not characters
hrc_rep_df$score_117 <- as.numeric(hrc_rep_df$score_117)
hrc_rep_df$score_116 <- as.numeric(hrc_rep_df$score_116)
hrc_rep_df$score_115 <- as.numeric(hrc_rep_df$score_115)

```


```{r}
#calculate their average score based on previous voting record
hrc_rep_df %>% 
  select(-last_name, - first_name) %>% #drop columns for tidiness
  pivot_longer(score_117:score_115, names_to = "session", values_to = "score") %>%
  group_by(name) %>% #group reps
  summarise(name = name,
            avg_score = round(mean(score, na.rm = T),2)) %>%
  unique() %>% #drop duplicates
  ungroup() %>%
  right_join(hrc_rep_df, by = "name") -> hrc_rep_df


```


The table below shows the House of Representatives and their scores of equality based on their voting record (when available). The column `avg_score` calculate the average of the available equality scores from the HRC. Not all Representatives served in prior congressional sessions, which is reflected by "NA" and does not count towards the `avg_score`. 

```{r}
#print table
hrc_rep_df %>%
  select(name, ID, avg_score, score_117, score_116, score_115) %>%
  arrange(name)%>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(height = "400px")
```



### Senators


```{r}

#rename score variabels
hrc_sen <- hrc_sen %>%
  rename(score_117 = score1,
         score_116 = score2,
         score_115 = score3)

#CHANGE THE CHARACTERS RE VOTING

hrc_sen %>% mutate_at(vars(5:24),
                            funs(case_when(
  . == "j" ~ "anti-HRC",
  . =="v" ~ "pro-HRC",
  . == "J" ~ "did not vote",
  . == "P" ~ "voted present",
  TRUE ~ .
))) -> hrc_sen


#clean up names

hrc_sen %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot1, "\\,")) %>%
  select(-spot3, -spot4, -spot5)%>%
  rename(last_name = spot1, first_name = spot2) -> hrc_sen_df



hrc_sen %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot2, "\\,")) %>%
  unite("last_name", spot1, spot2, sep = " ") %>%
  select(-spot4, -spot5) %>%
  rename(first_name = spot3) -> hrc_sen_df2

hrc_sen_df <- bind_rows(hrc_sen_df, hrc_sen_df2)


hrc_sen %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot3, "\\,")) %>%
  select(-spot1, -spot2, -spot5) %>%
  rename(last_name = spot3, first_name = spot4) -> hrc_sen_df2

hrc_sen_df <- bind_rows(hrc_sen_df, hrc_sen_df2)


hrc_sen %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot4, "\\,")) %>%
  select(-spot1, -spot2, -spot3) %>%
  rename(last_name = spot4, first_name = spot5) -> hrc_sen_df2

hrc_sen_df <- bind_rows(hrc_sen_df, hrc_sen_df2)

#make a new column with their name
hrc_sen_df <- hrc_sen_df %>% unite("name", first_name, last_name, sep = " ", remove = F) 

hrc_sen_df <- hrc_sen_df %>% mutate(name = str_replace_all(name,"[[:punct:]]", ""))

hrc_sen_df$name <- str_squish(hrc_sen_df$name)

#Robert/Bob Casey's name got messed up 
hrc_sen_df <- hrc_sen_df %>% 
  mutate(name = case_when(
  name == "Robert Jr" ~ "Bob Casey",
  TRUE ~ name),
  last_name = case_when(
    last_name == "Jr.," ~ "Casey Jr.",
TRUE ~ last_name
))


# Convert scores to numeric

hrc_sen_df$score_117 <- as.numeric(hrc_sen_df$score_117)
hrc_sen_df$score_116 <- as.numeric(hrc_sen_df$score_116)
hrc_sen_df$score_115 <- as.numeric(hrc_sen_df$score_115)

```


```{r}
#Calculate average score based on previous voting record

hrc_sen_df %>%
  select(-last_name, -first_name) %>% #drop columns for tidiness
  pivot_longer(score_117:score_115, names_to = "session", values_to = "score") %>%
  group_by(name) %>% #group reps
  summarise(name = name,
            avg_score = round(mean(score, na.rm = T),2)) %>%
  unique() %>% #drop duplicates
  ungroup() %>% #ungroup observations
  right_join(hrc_sen_df, by = "name") -> hrc_sen_df

```

The table below shows the Senators and their scores of equality based on their voting record (when available). The column `avg_score` calculate the average of the available equality scores from the HRC. Not all Senators served in prior congressional sessions, which is reflected by "NA" and does not count towards the `avg_score`. 

```{r}
#print table
hrc_sen_df %>%
  select(name, ID, avg_score, score_117, score_116, score_115) %>%
  arrange(name)%>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(height = "400px")
```



# ASHA-PAC's Spending by HRC Score{.tabset}

```{r}
#Make sure names align across DFs

### Representatives

hrc_rep_df$name <- str_squish(hrc_rep_df$name)

hrc_rep_df %>% mutate(name = case_when(
  name == "Frank Pallone Jr," ~ "Frank Pallone Jr.",
  name == "Joe Neguse" ~ "Joseph Neguse",
  name == "GK. Butterfield," ~ "G K Butterfield",
  name == "Lauren Underwood" ~ "Lauren A Underwood",
  name == "Robert Latta" ~ "Bob Latta",
  name == "Robert Scott" ~ "Bobby Scott",
  name == "Richard Neal" ~ "Richard E Neal",
  name == "Bobby Rush" ~ "Bobby L Rush",
  name == "Steny Hoyer" ~ "Steny H Hoyer",
  name == "Vern Buchanan" ~ "Vernon Buchanan",
  name == "Matthew Cartwright" ~ "Matt Cartwright",
  name == "Yvette Clarke" ~ "Yvette D Clarke",
  name == "James Clyburn" ~ "James E Clyburn",
  name == "Danny Davis" ~ "Danny K Davis",
  name == "Tom OHalleran," ~ "Tom O'Halleran",
  name == "Bill Pascrell Jr," ~ "Bill Pascrell Jr.",
  name == "Lucille RoybalAllard," ~ "Lucille Roybal-Allard",
  name == "Terri Sewell" ~ "Terri A Sewell",
  name == "Thomas Suozzi" ~ "Tom Suozzi",
  TRUE ~ name
)) -> hrc_rep_df

ashaPAC %>% mutate(name = case_when(
  name == "Mark Desaulnier" ~ "Mark DeSaulnier",
  name == "David P Joyce" ~ "David Joyce",
  name == "Nanette Barragan" ~ "Nanette Barragán",
  name == "Tony Cardenas" ~ "Tony Cárdenas",
  name == "Yvette Clarke" ~ "Yvette D Clarke",
  name == "Linda Sanchez" ~ "Linda Sánchez",
  name == "Terri Sewell" ~ "Terri A Sewell",

  TRUE ~ name
)) -> ashaPAC

```




```{r}

#The following names are Representatives not in the HRC data for the 117th congress. The ones who are not included were in the 116th congress. Their data will be manually added based on the [HRC's report on the 116th Congress](https://hrc-prod-requests.s3-us-west-2.amazonaws.com/116th-Congressional-Scorecard-060921.pdf).   

# ashaPAC %>% filter(role == "Representative") %>%
#   anti_join(hrc_rep_df, by = "name") %>%
#     kbl(table.attr = "style = \"color: black;\"") %>%
#   kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
#   scroll_box(height = "400px")
```


```{r}
### Clean up the names of the Senators

hrc_sen_df$name <- str_squish(hrc_sen_df$name)

hrc_sen_df %>% mutate(name = case_when(
  name == "Charles Schumer" ~ "Chuck Schumer",
  name == "Cindy HydeSmith" ~ "Cindy Hyde-Smith",
  name == "William Cassidy" ~ "Bill Cassidy",
  name == "Richard Durbin" ~ "Dick Durbin",
  name == "Shelley Capito" ~ "Shelley Moore Capito",
  TRUE ~ name
)) -> hrc_sen_df

ashaPAC %>% mutate(name = case_when(
  name == "Ben Ray Lujan" ~ "Ben Luján",
  TRUE ~ name
)) -> ashaPAC

#Remove dollar sign from ASHA-PAC total

ashaPAC <- ashaPAC %>% mutate(ASHA_PAC_total = str_replace_all(ASHA_PAC_total, "\\$", ""))
ashaPAC$ASHA_PAC_total<-as.numeric(ashaPAC$ASHA_PAC_total)
```



```{r}
#Senators whose names don't match up:

# ashaPAC %>% filter(role == "Senator") %>%
#   anti_join(hrc_sen_df, by = "name") %>%
#   kbl(table.attr = "style = \"color: black;\"") %>%
#   kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
#   scroll_box(height = "400px")
```




## 2022{.tabset}


### Senators{.tabset}

Senators who won their race, their HRC scores, and the amount that ASHA-PAC has donated to their 2022 campaigns.



```{r}
#Combine data from HRC and ASHA-PAC spending

ashaPAC %>% select(name, party, state, ASHA_PAC_total, year, role) %>%
  filter(year == "2022", role == "Senator") %>%
  left_join(hrc_sen_df %>% 
              select(name,avg_score, score_117:score_115), by = "name") -> asha_2022_sen

#add Markwayne Mullin's info from Representative HRC data

asha_2022_sen <- asha_2022_sen %>% 
  mutate(score_117 = case_when(
  name == "Markwayne Mullin" ~ 6,
  TRUE ~ score_117),
  score_116 = case_when(
  name == "Markwayne Mullin" ~ 0,
  TRUE ~ score_116),
  score_115 = case_when(
  name == "Markwayne Mullin" ~ 0,
  TRUE ~ score_115),
  avg_score = case_when(
  name == "Markwayne Mullin" ~ (6/3),
  TRUE ~ avg_score  
  ))

asha_2022_sen %>%
  arrange(desc(ASHA_PAC_total)) %>%
  relocate(name, ASHA_PAC_total, avg_score:score_115)%>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(height = "400px")
```

```{r}
paste("The total amount of money ASHA-PAC donated to Senators' 2022 winning campaigns:", sum(asha_2022_sen$ASHA_PAC_total), "dollars.")
```

#### Money by Most Recent HRC Rating

Splitting the `score_117` into 0, 1-25, 26-50, 51-75, and 75-100 and see how much money is spent.

```{r}
asha_2022_sen <- asha_2022_sen %>%
  mutate(groups_117 = case_when(
    score_117 == 0 ~ "0",
    score_117 <= 25 ~ "1-25",
    score_117 <= 50 ~ "26-50",
    score_117 <= 75 ~ "51-75",
    score_117 <= 100 ~ "76-100"
  ),
    groups_116 = case_when(
    score_116 == 0 ~ "0",
    score_116 <= 25 ~ "1-25",
    score_116 <= 50 ~ "26-50",
    score_116 <= 75 ~ "51-75",
    score_116 <= 100 ~ "76-100"))

asha_2022_sen %>% 
  group_by(groups_117) %>%
  summarise(n = n(), money_spent = sum(ASHA_PAC_total),
            percent_spent = round((money_spent/43000)*100,2)) %>%
  as_tibble() %>% rmarkdown::paged_table()
```

ASHA-PAC donated: 

- $14,000 to campaigns given an HRC score of less than 25 

- $6,000 to campaigns given an HRC score between 51-75

- $20,500 to campaigns given an HRC score above 75


Approximately a third of their donations went towards candidates with a score of less than 25.


#### Money by Average HRC Rating

Splitting the `avg_score` into 0, 1-25, 26-50, 51-75, and 75-100 and see how much money is spent.

```{r}
asha_2022_sen <- asha_2022_sen %>%
  mutate(groups_avg = case_when(
    avg_score == 0 ~ "0",
    avg_score <= 25 ~ "1-25",
    avg_score <= 50 ~ "26-50",
    avg_score <= 75 ~ "51-75",
    avg_score <= 100 ~ "76-100"
  ))

asha_2022_sen %>% 
  group_by(groups_avg) %>%
  summarise(n = n(), money_spent = sum(ASHA_PAC_total),
            percent_spent = round((money_spent/43000)*100,2)) %>%
  as_tibble() %>% rmarkdown::paged_table()
```

**Based on Senators' average score over the the most recent congressional sessions**

ASHA-PAC donated: 

- $11,500 to campaigns given an HRC score of less than 25 

- $6,000 to campaigns given an HRC score between 26-50

- $5,000 to campaigns given an HRC score between 51-75

- $20,500 to campaigns given an HRC score above 75


**Approximately 41% of their donations went to campaigns with an average record of an HRC equality score $\leq$ 50.** 



### Representatives{.tabset}

Representatives who won their race, their HRC scores, and the amount that ASHA-PAC has donated to their 2022 campaigns.

```{r}
ashaPAC %>% select(name, party, state, ASHA_PAC_total, year, role) %>%
  filter(year == "2022", role == "Representative") %>%
  left_join(hrc_rep_df %>% 
              select(name,avg_score, score_117:score_115), by = "name") -> asha_2022_rep


asha_2022_rep %>%
  arrange(desc(ASHA_PAC_total)) %>%
  relocate(name, ASHA_PAC_total, avg_score:score_115)%>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(height = "400px")
```


```{r}
paste("The total amount of money ASHA-PAC donated to Representatives' 2022 Campaigns:", sum(asha_2022_rep$ASHA_PAC_total), "dollars.")
```

#### Money by Most Recent HRC Rating

Splitting the `score_117` into 0, 1-25, 26-50, 51-75, and 75-100 and see how much money is spent.

```{r}
asha_2022_rep <- asha_2022_rep %>%
  mutate(groups_117 = case_when(
    score_117 == 0 ~ "0",
    score_117 <= 25 ~ "1-25",
    score_117 <= 50 ~ "26-50",
    score_117 <= 75 ~ "51-75",
    score_117 <= 100 ~ "76-100"
  ),
    groups_116 = case_when(
    score_116 == 0 ~ "0",
    score_116 <= 25 ~ "1-25",
    score_116 <= 50 ~ "26-50",
    score_116 <= 75 ~ "51-75",
    score_116 <= 100 ~ "76-100"))

asha_2022_rep %>% 
  group_by(groups_117) %>%
  summarise(n = n(), money_spent = sum(ASHA_PAC_total),
            percent_spent = round((money_spent/126500)*100,2)) %>%
  as_tibble() %>% rmarkdown::paged_table()
```


ASHA-PAC donated: 

- $32,000 to campaigns given an HRC score of 0 (over 25% of the total money spent)

- $12,000 to campaigns given an HRC score of less than 25 

- $6,000 to campaigns given an HRC score between 26-50

- $76,500 to campaigns given an HRC score above 75

That's $50,000 to campaigns with a score less than 50, or ~40% of their campaign donations.

```{r}
# asha_2022_rep %>%
#   ggplot(aes(groups_117, ASHA_PAC_total)) + geom_bar(stat = "identity")


# asha_2022_rep %>%
#   ggplot(aes(groups_117, ASHA_PAC_total)) + 
#   geom_boxplot(width = .5, outlier.shape = NA) +
#   geom_jitter(width = .1, alpha = .5)+
#   theme_minimal() +
#   labs(x = "HRC Rating in 25pt intervals",
#        y = "Inidivudal Campaign Donations Amount ($)",
#        title = "ASHA-PAC's 2022 Representative Campaign Donations")+
#   theme(plot.title = element_text(hjust = .5))
```


#### Money by Average HRC Rating

Splitting the `avg_score` into 0, 1-25, 26-50, 51-75, and 75-100 and see how much money is spent.

```{r}
asha_2022_rep <- asha_2022_rep %>%
  mutate(groups_avg = case_when(
    avg_score == 0 ~ "0",
    avg_score <= 25 ~ "1-25",
    avg_score <= 50 ~ "26-50",
    avg_score <= 75 ~ "51-75",
    avg_score <= 100 ~ "76-100"
  ))

asha_2022_rep %>% 
  group_by(groups_avg) %>%
  summarise(n = n(), money_spent = sum(ASHA_PAC_total),
            percent_spent = round((money_spent/126500)*100,2)) %>%
  as_tibble() %>% rmarkdown::paged_table()
```

**Based on Representatives' average score over the the most recent congressional sessions**

ASHA-PAC donated: 

- $32,000 to campaigns given an HRC score of 0 (over 25% of the total money spent)

- $18,000 to campaigns given an HRC score of less than 25 

- $76,500 to campaigns given an HRC score above 75

That's 50,000 dollars to campaigns with an HRC equality score $\leq$ 50, or ~40% of their campaign donations.


## 2020{.tabset}


### Senators{.tabset}

Senators who won their race, their HRC scores, and the amount that ASHA-PAC donated to their 2020 campaigns.

```{r}
ashaPAC %>% select(name, party, state, ASHA_PAC_total, year, role) %>%
  filter(year == "2020", role == "Senator") %>%
  left_join(hrc_sen_df %>% 
              select(name,avg_score, score_117:score_115), by = "name") -> asha_2020_sen

asha_2020_sen <- asha_2020_sen %>%
  mutate(score_116 = case_when(
    name == "Joe Kennedy III" ~ 100,
    TRUE ~ score_116),
    score_115 = case_when(
    name == "Joe Kennedy III" ~ 100,
    TRUE ~ score_115
    ),
    avg_score = case_when(
      name == "Joe Kennedy III" ~ 100,
      TRUE ~ avg_score
    ))

asha_2020_sen %>%
  arrange(desc(ASHA_PAC_total)) %>%
  relocate(name, ASHA_PAC_total, avg_score:score_115)%>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(height = "400px")
```

Total $ Donated

```{r}
paste("The total amount of money ASHA-PAC donated to Senators' 2020 Campaigns:", sum(asha_2020_sen$ASHA_PAC_total), "dollars.")
```

#### Money by Most Recent HRC Rating

```{r}
asha_2020_sen <- asha_2020_sen %>%
  mutate(groups_117 = case_when(
    score_117 == 0 ~ "0",
    score_117 <= 25 ~ "1-25",
    score_117 <= 50 ~ "26-50",
    score_117 <= 75 ~ "51-75",
    score_117 <= 100 ~ "76-100"
  ),
    groups_116 = case_when(
    score_116 == 0 ~ "0",
    score_116 <= 25 ~ "1-25",
    score_116 <= 50 ~ "26-50",
    score_116 <= 75 ~ "51-75",
    score_116 <= 100 ~ "76-100"))

asha_2020_sen %>% 
  group_by(groups_117) %>%
  summarise(n = n(), money_spent = sum(ASHA_PAC_total),
            percent_spent = round((money_spent/27500)*100,2)) %>%
  as_tibble() %>% rmarkdown::paged_table()
```

**Based on Senators' most recent HRC equality score**

In 2020, ASHA-PAC donated: 

- $9,000 to campaigns given an HRC score less than 25 

- $3,500 to campaigns given an HRC score between 51-75

- $14,000 to campaigns given an HRC score above 75

Approximately a third of their donations went towards candidates with a score of less than 25.

#### Money by Average HRC Rating

```{r}
asha_2020_sen <- asha_2020_sen %>%
  mutate(groups_avg = case_when(
    avg_score == 0 ~ "0",
    avg_score <= 25 ~ "1-25",
    avg_score <= 50 ~ "26-50",
    avg_score <= 75 ~ "51-75",
    avg_score <= 100 ~ "76-100"
  ))

asha_2020_sen %>% 
  group_by(groups_avg) %>%
  summarise(n = n(), money_spent = sum(ASHA_PAC_total),
            percent_spent = round((money_spent/27500)*100,2)) %>%
  as_tibble() %>% rmarkdown::paged_table()
```

**Based on Senators' average HRC equality score**

In 2020, ASHA-PAC donated: 

- $9,000 to campaigns given an HRC score less than 25 

- $3,500 to campaigns given an HRC score between 51-75

- $15,000 to campaigns given an HRC score above 75

**Approximately a third of their donations went towards candidates with an average score $\leq$ 25.**

**Approximately 45% of their donations went towards candidates with an average score $\leq$ 50.**

### Representatives{.tabset}

Representatives who won their race, their HRC scores, and the amount that ASHA-PAC  donated to their 2020 campaigns.

```{r}
ashaPAC %>% select(name, party, state, ASHA_PAC_total, year, role) %>%
  filter(year == "2020", role == "Representative") %>%
  left_join(hrc_rep_df %>% 
              select(name,avg_score, score_117:score_115), by = "name") -> asha_2020_rep

#asha_2020_rep %>% filter(is.na(score_116))


asha_2020_rep <- asha_2020_rep %>%
  mutate(
    score_116 = case_when(
      name == "Donna Shalala" ~ 100, #na for 115
      name == "Nita M Lowey" ~ 100, #100 for 115
      name == "Greg Walden" ~ 47, #0 for 115
      name == "Kendra Horn" ~ 88, #NA for 115
      name == "Anthony Brindisi" ~ 88, #NA for 115
      name == "George Holding" ~ 0, # 0 for 115
      #name == "John Lewis" ~
      name == "Pete Olson" ~ 7, #0 for 115
      name == "Tom Reed" ~ 47, #43 for 115
      name == "Steve Stivers" ~ 28, #0 for 115,
      TRUE ~ score_116
    ),
     score_115 = case_when(
     # name == "Donna Shalala" ~ 100, #na for 115
      name == "Nita M Lowey" ~ 100, #100 for 115
      name == "Greg Walden" ~ 0, #0 for 115
     # name == "Kendra Horn" ~ 88, #NA for 115
     # name == "Anthony Brindisi" ~ 88, #NA for 115
      name == "George Holding" ~ 0, # 0 for 115
      #name == "John Lewis" ~
      name == "Pete Olson" ~ 0, #0 for 115
      name == "Tom Reed" ~ 43, #43 for 115
      name == "Steve Stivers" ~ 0, #0 for 115,
      TRUE ~ score_115)
  )

#Need to recalculate the average scores since I manually added in the above scores

asha_2020_rep %>%
  select(name, score_117:score_115) %>% #keep only relevant info
  pivot_longer(score_117:score_115, names_to = "session", values_to = "score") %>%
  group_by(name) %>%
  summarise(name = name,
            avg_score = round(mean(score, na.rm = T),2)) %>%
  unique() %>%
  ungroup() %>%
  right_join(asha_2020_rep %>% select(-avg_score), by = "name") -> asha_2020_rep


```


```{r}
asha_2020_rep %>%
  arrange(desc(ASHA_PAC_total)) %>%
  relocate(name, ASHA_PAC_total, avg_score, score_117:score_115)%>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(height = "400px")
```



Total $ Donated

```{r}
paste("The total amount of money ASHA-PAC donated to Representatives' 2020 Campaigns:", sum(asha_2020_rep$ASHA_PAC_total), "dollars.")
```

#### Money by Most Recent HRC Rating

```{r}
asha_2020_rep <- asha_2020_rep %>%
  mutate(groups_117 = case_when(
    score_117 == 0 ~ "0",
    score_117 <= 25 ~ "1-25",
    score_117 <= 50 ~ "26-50",
    score_117 <= 75 ~ "51-75",
    score_117 <= 100 ~ "76-100"
  ),
  groups_116 = case_when(
    score_116 == 0 ~ "0",
    score_116 <= 25 ~ "1-25",
    score_116 <= 50 ~ "26-50",
    score_116 <= 75 ~ "51-75",
    score_116 <= 100 ~ "76-100"
  ))

asha_2020_rep %>% 
  group_by(groups_117) %>%
  summarise(n = n(), money_spent = sum(ASHA_PAC_total),
            percent_spent = round((money_spent/265500)*100,2)) %>%
  as_tibble() %>% rmarkdown::paged_table()
```

In 2020, ASHA-PAC donated: 

- $56,000 to campaigns given an HRC score of 0 (over 21% of the total money spent)

- $27,500 to campaigns given an HRC score of less than 25 

- $4,000 to campaigns given an HRC score between 26-50

- $3,500 to campaigns given an HRC score between 51-75

- $157,500 to campaigns given an HRC score above 75

$87,500 or approximately 32.96% of their total campaign spending went towards campaigns with a score of less than 50 in 2020. 


#### Money by Average HRC Rating

```{r}
asha_2020_rep <- asha_2020_rep %>%
  mutate(groups_avg = case_when(
    avg_score == 0 ~ "0",
    avg_score <= 25 ~ "1-25",
    avg_score <= 50 ~ "26-50",
    avg_score <= 75 ~ "51-75",
    avg_score <= 100 ~ "76-100"
  ))

asha_2020_rep %>% 
  group_by(groups_avg) %>%
  summarise(n = n(), money_spent = sum(ASHA_PAC_total),
            percent_spent = round((money_spent/265500)*100,2)) %>%
  as_tibble() %>% rmarkdown::paged_table()
```

**Based on Representatives' average most recent HRC equality scores**

In 2020, ASHA-PAC donated:

- $57,000 to campaigns given an HRC score of 0 (over 21% of the total money spent)

- $33,500 to campaigns given an HRC score of less than 25 

- $6,000 to campaigns given an HRC score between 26-50

- $1,00 to campaigns given an HRC score between 51-75

- $167,00 to campaigns given an HRC score above 75

96,500 or approximately 36.35% of their total campaign spending went towards campaigns with an average HRC equality score $\leq$ 50 in 2020. 


# ASHA-PAC Spending over time{.tabset}

```{r}
# ashaPAC has money spent and year, and role

#Make a separate df to examine spending over time, extracting only relevant information and aligning variables to graph the data

asha_2020_rep %>% 
  mutate(year_chamber = "2020 HoR",
         hrc_category = groups_116) %>%
  select(name, party, state, ASHA_PAC_total, year_chamber, hrc_category) -> over_time

asha_2020_sen%>% 
  mutate(year_chamber = "2020 Senate",
         hrc_category = groups_116) %>%
  select(name, party, state, ASHA_PAC_total, year_chamber, hrc_category) %>%
  bind_rows(over_time) -> over_time

asha_2022_rep%>% 
  mutate(year_chamber = "2022 HoR",
         hrc_category = groups_117) %>%
  select(name, party, state, ASHA_PAC_total, year_chamber, hrc_category) %>%
  bind_rows(over_time) -> over_time

asha_2022_sen%>% 
  mutate(year_chamber = "2022 Senate",
         hrc_category = groups_117) %>%
  select(name, party, state, ASHA_PAC_total, year_chamber, hrc_category) %>%
  bind_rows(over_time) -> over_time

```


## Static Plot

```{r}

set.seed(20)
#graph spending

over_time %>%
  filter(!is.na(hrc_category)) %>%
  ggplot(aes(year_chamber, ASHA_PAC_total, color = hrc_category)) + 
  geom_jitter(width = .2, 
              height = 200, 
              alpha = .8,
              size = 5)+
  theme_minimal() +
  theme(panel.background = element_rect(fill = "lightgray"))+
  labs(x = "Year & Chamber of Congress",
       y = "ASHA-PAC Campaign Contribution ($)") +
 # scale_color_discrete(name = "HRC Score") + 
  scale_color_brewer(palette = "YlOrRd", 
                     direction = -1,
                     name = "HRC Score")
```

## Reactive Plot

```{r}

set.seed(20)
#graph spending

p <- over_time %>%
  filter(!is.na(hrc_category)) %>%
  ggplot(aes(year_chamber, ASHA_PAC_total, color = hrc_category)) + 
  geom_jitter(width = .2, 
              height = 200, 
              alpha = .8,
              size = 5)+
  theme_minimal() +
  theme(panel.background = element_rect(fill = "lightgray"))+
  labs(x = "Year & Chamber of Congress",
       y = "ASHA-PAC Campaign Contribution ($)") +
 # scale_color_discrete(name = "HRC Score") + 
  scale_color_brewer(palette = "YlOrRd", 
                     direction = -1,
                     name = "HRC Score")

ggplotly(p)
```

