---
title: "ASHA's Political Campaign Donations and HRC Score Card"
author: "Brett Welch, MS, CCC-SLP"
date: "6/13/2023"
output: 
  html_document:
    toc: true
    toc_float: true
    code_folding: hide
    theme: sandstone
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = T,
                      warning = F,
                      message = F)
```


```{r}
library(tidyverse, quietly = T)
library(readxl)
library(gt)
library(kableExtra)
library(janitor)
library(pdftools)

```



# Data

## ASHA PAC's Spending{.tabset}

These data were obtained from [OpenSecrets.org](https://www.opensecrets.org/). Specifically data from ASHA PAC's spending on [2020 House and Senate candidates](https://www.opensecrets.org/political-action-committees-pacs/american-speech-language-hearing-assn/C00210666/candidate-recipients/2020) and [2022 House and Senate candidates](https://www.opensecrets.org/political-action-committees-pacs/american-speech-language-hearing-assn/C00210666/candidate-recipients/2022). 

### 2020{.tabset}

#### House

```{r}
asha_2020_rep <- read.csv("/Users/brett/Documents/R/PoliticalSpreadsheet/ASHA_PAC/ASHA_2020_candidateSpending_house.csv")

asha_2020_rep %>% separate(Candidate, 
                           into = c("Name", "ID"), 
                           sep = "\\(",
                           remove = F) %>%
  separate(ID,
           into = c("Party", "State"),
           sep = "\\-") -> asha_2020_rep

#clean up labels for states

asha_2020_rep %>%
  mutate(State = case_when(
    State == "Fla)" ~ "FL",
    State == "WVa)" ~ "WV",
    State == "Mass)" ~ "MA",
    State == "NJ)" ~ "NJ",
    State == "Calif)" ~ "CA",
    State == "Texas)" ~ "TX",
    State == "Ky)" ~ "KY",
    State == "Wash)" ~ "WA",
    State == "NC)" ~ "NC",
    State == "Wis)" ~ "WI",
    State == "Ill)" ~ "IL",
    State == "Va)" ~ "VA",
    State == "Pa)" ~ "PA",
    State == "NY)" ~ "NY",
    State == "Del)" ~ "DE",
    State == "Conn)" ~ "CT",
    State == "Ore)" ~ "OR",
    State == "Mich)" ~ "MI",
    State == "Vt)" ~ "VT",
    State == "Ohio)" ~ "OH",
    State == "Colo)" ~ "CO",
    State == "Md)" ~ "MD",
    State == "SC)" ~ "SC",
    State == "LA)" ~ "LA",
    State == "Minn)" ~ "MN",
    State == "Okla)" ~ "OK",
    State == "Mo)" ~ "MO",
    State == "Nev)" ~ "NV",
    State == "Iowa)" ~ "IA",
    State == "Ga)" ~ "GA",
    State == "Ark)" ~ "AR",
    State == "NH)" ~ "NH",
    State == "Ariz)" ~ "AZ",
    State == "Ala)" ~ "AL",
    State == "Neb)" ~ "NE"
  )) -> asha_2020_rep

#unique(asha_2020_rep$State)

asha_2020_rep <- asha_2020_rep %>% clean_names()

asha_2020_rep$name <- str_squish(asha_2020_rep$name)


```

A list of Representatives ASHA donated money to for their 2020 campaign

```{r}
asha_2020_rep %>% 
  select(-candidate) %>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(width = "50%", height = "400px")
```


#### Senate

```{r}
asha_2020_sen <- read.csv("/Users/brett/Documents/R/PoliticalSpreadsheet/ASHA_PAC/ASHA_2020_candidateSpending_senate.csv")



asha_2020_sen %>% separate(Candidate, 
                           into = c("Name", "ID"), 
                           sep = "\\(",
                           remove = F) %>%
  separate(ID,
           into = c("Party", "State"),
           sep = "\\-") -> asha_2020_sen

#clean up state labels

asha_2020_sen %>%
  mutate(State = case_when(
    State == "Fla)" ~ "FL",
    State == "WVa)" ~ "WV",
    State == "Mass)" ~ "MA",
    State == "NJ)" ~ "NJ",
    State == "Calif)" ~ "CA",
    State == "Texas)" ~ "TX",
    State == "Ky)" ~ "KY",
    State == "Wash)" ~ "WA",
    State == "NC)" ~ "NC",
    State == "Wis)" ~ "WI",
    State == "Ill)" ~ "IL",
    State == "Va)" ~ "VA",
    State == "Pa)" ~ "PA",
    State == "NY)" ~ "NY",
    State == "Del)" ~ "DE",
    State == "Conn)" ~ "CT",
    State == "Ore)" ~ "OR",
    State == "Mich)" ~ "MI",
    State == "Vt)" ~ "VT",
    State == "Ohio)" ~ "OH",
    State == "Colo)" ~ "CO",
    State == "Md)" ~ "MD",
    State == "SC)" ~ "SC",
    State == "LA)" ~ "LA",
    State == "La)" ~ "LA",
    State == "Minn)" ~ "MN",
    State == "Okla)" ~ "OK",
    State == "Mo)" ~ "MO",
    State == "Nev)" ~ "NV",
    State == "Iowa)" ~ "IA",
    State == "Ga)" ~ "GA",
    State == "Ark)" ~ "AR",
    State == "NH)" ~ "NH",
    State == "Ariz)" ~ "AZ",
    State == "Ala)" ~ "AL",
    State == "Neb)" ~ "NE",
    State == "Maine)" ~ "ME",
    State == "Miss)" ~ "MS",
    State == "NM)" ~ "NM",
    
    TRUE ~ State
  )) -> asha_2020_sen

# unique(asha_2020_sen$State)

asha_2020_sen <- asha_2020_sen %>% clean_names()

asha_2020_sen$name <- str_squish(asha_2020_sen$name)

```

A list of Senators that ASHA donated money to for their 2020 campaign.

```{r}
asha_2020_sen %>% 
  select(-candidate) %>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(width = "50%", height = "400px")
```


### 2022{.tabset}

#### House

```{r}
asha_2022_rep <- read.csv("/Users/brett/Documents/R/PoliticalSpreadsheet/ASHA_PAC/ASHA_2022_candidateSpending_house.csv")

asha_2022_rep %>% separate(Candidate, 
                           into = c("Name", "ID"), 
                           sep = "\\(",
                           remove = F) %>%
  separate(ID,
           into = c("Party", "State"),
           sep = "\\-") -> asha_2022_rep

#Clean up state labels

asha_2022_rep %>%
  mutate(State = case_when(
    State == "Fla)" ~ "FL",
    State == "WVa)" ~ "WV",
    State == "Mass)" ~ "MA",
    State == "NJ)" ~ "NJ",
    State == "Calif)" ~ "CA",
    State == "Texas)" ~ "TX",
    State == "Ky)" ~ "KY",
    State == "Wash)" ~ "WA",
    State == "NC)" ~ "NC",
    State == "Wis)" ~ "WI",
    State == "Ill)" ~ "IL",
    State == "Va)" ~ "VA",
    State == "Pa)" ~ "PA",
    State == "NY)" ~ "NY",
    State == "Del)" ~ "DE",
    State == "Conn)" ~ "CT",
    State == "Ore)" ~ "OR",
    State == "Mich)" ~ "MI",
    State == "Vt)" ~ "VT",
    State == "Ohio)" ~ "OH",
    State == "Colo)" ~ "CO",
    State == "Md)" ~ "MD",
    State == "SC)" ~ "SC",
    State == "LA)" ~ "LA",
    State == "La)" ~ "LA",
    State == "Minn)" ~ "MN",
    State == "Okla)" ~ "OK",
    State == "Mo)" ~ "MO",
    State == "Nev)" ~ "NV",
    State == "Iowa)" ~ "IA",
    State == "Ga)" ~ "GA",
    State == "Ark)" ~ "AR",
    State == "NH)" ~ "NH",
    State == "Ariz)" ~ "AZ",
    State == "Ala)" ~ "AL",
    State == "Neb)" ~ "NE",
    State == "Maine)" ~ "ME",
    State == "Miss)" ~ "MS",
    State == "NM)" ~ "NM",
    State == "Ind)" ~ "IN",
    State == "ND)" ~ "ND",
    State == "Wyo)" ~ "WY",
    State == "Utah)" ~ "UT",
    
    TRUE ~ State
  )) -> asha_2022_rep

asha_2022_rep <- asha_2022_rep %>% clean_names()

asha_2022_rep$name <- str_squish(asha_2022_rep$name)

```

A list of Representatives ASHA donated money to for their 2022 campaign

```{r}
asha_2022_rep %>% 
  select(-candidate) %>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(width = "50%", height = "400px")
```


#### Senate

```{r}
asha_2022_sen <- read.csv("/Users/brett/Documents/R/PoliticalSpreadsheet/ASHA_PAC/ASHA_2022_candidateSpending_senate.csv")

asha_2022_sen %>% separate(Candidate, 
                           into = c("Name", "ID"), 
                           sep = "\\(",
                           remove = F) %>%
  separate(ID,
           into = c("Party", "State"),
           sep = "\\-") -> asha_2022_sen

asha_2022_sen %>%
  mutate(State = case_when(
    State == "Fla)" ~ "FL",
    State == "WVa)" ~ "WV",
    State == "Mass)" ~ "MA",
    State == "NJ)" ~ "NJ",
    State == "Calif)" ~ "CA",
    State == "Texas)" ~ "TX",
    State == "Ky)" ~ "KY",
    State == "Wash)" ~ "WA",
    State == "NC)" ~ "NC",
    State == "Wis)" ~ "WI",
    State == "Ill)" ~ "IL",
    State == "Va)" ~ "VA",
    State == "Pa)" ~ "PA",
    State == "NY)" ~ "NY",
    State == "Del)" ~ "DE",
    State == "Conn)" ~ "CT",
    State == "Ore)" ~ "OR",
    State == "Mich)" ~ "MI",
    State == "Vt)" ~ "VT",
    State == "Ohio)" ~ "OH",
    State == "Colo)" ~ "CO",
    State == "Md)" ~ "MD",
    State == "SC)" ~ "SC",
    State == "LA)" ~ "LA",
    State == "La)" ~ "LA",
    State == "Minn)" ~ "MN",
    State == "Okla)" ~ "OK",
    State == "Mo)" ~ "MO",
    State == "Nev)" ~ "NV",
    State == "Iowa)" ~ "IA",
    State == "Ga)" ~ "GA",
    State == "Ark)" ~ "AR",
    State == "NH)" ~ "NH",
    State == "Ariz)" ~ "AZ",
    State == "Ala)" ~ "AL",
    State == "Neb)" ~ "NE",
    State == "Maine)" ~ "ME",
    State == "Miss)" ~ "MS",
    State == "NM)" ~ "NM",
    State == "Ind)" ~ "IN",
    State == "ND)" ~ "ND",
    State == "Wyo)" ~ "WY",
    State == "Utah)" ~ "UT",
    State == "Alaska)" ~ "AK",
    State == "SD)" ~ "SD",
    
    TRUE ~ State
  )) -> asha_2022_sen

asha_2022_sen <- asha_2022_sen %>% 
  clean_names()

asha_2022_sen$name <- str_squish(asha_2022_sen$name)


```

A list of Senators that ASHA donated money to for their 2022 campaign

```{r}
asha_2022_sen %>% 
  select(-candidate) %>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(width = "50%", height = "400px")
```



```{r}
#Change names across DFs so they match
#anti_join(asha_2022_sen, senators, by = "name")

asha_2022_sen <- asha_2022_sen %>%
  mutate(name = case_when(
    name == "Charles E Schumer" ~ "Chuck Schumer",
    name == "John A Barrasso" ~ "John Barrasso",
    TRUE ~ name
  )) %>%
  rename(ASHA_total = total) %>%
  mutate(year = 2022,
         role = "Senator")

#rename total to ASHA_total, add role (senator/rep) and year for a single DF

asha_2022_rep <- asha_2022_rep %>% 
  rename(ASHA_total = total) %>%
  mutate(year = 2022,
         role = "Representative")

asha_2020_rep <- asha_2020_rep %>% 
  rename(ASHA_total = total) %>%
    mutate(year = 2020,
         role = "Representative")

asha_2020_sen <- asha_2020_sen %>% 
  rename(ASHA_total = total) %>%
    mutate(year = 2020,
         role = "Senator")

#combine information into a single DF

ashaPAC <- bind_rows(asha_2022_rep, asha_2022_sen, asha_2020_rep, asha_2020_sen)

ashaPAC$name <- str_squish(ashaPAC$name) #get rid of extra spaces

```



## HRC Scorecard{.tabset}

Data from [HRC's Scorecard on the 117th, 116th, and 115th Congress are available here](https://hrc-prod-requests.s3-us-west-2.amazonaws.com/assets/117th-Congressional-Scorecard_web.cleaned.pdf).

```{r}
#I was originally prepared to enter these data manually, but figured out a way around this.

# ashaPAC %>% mutate(score_117 = case_when(
#   name == "Frank Pallone Jr." ~ 96,
#   name == "Cathy McMorris Rodgers" ~ 0,
#   name == "Gus Bilirakis" ~ 0,
#   name == "Rodney Davis" ~ 26,
# ))
```

### Code used to scrape data

```{r}
#Please don't judge my code lol
#This was the first time I was scraping data from a PDF and did a lot of on-the-fly trouble shooting - I'm sure there was a more efficient way

hrc <- pdf_text("/Users/brett/Documents/R/PoliticalSpreadsheet/ASHA_PAC/117th-Congressional-Scorecard_web.cleaned.pdf")
```

```{r}
################# Page 8 
#hrc[8]

senators1 <- hrc[8]

#strsplit(senators1, "\n")

x1 <- strsplit(senators1, "\n")

x1 <- x1[[1]]

#x1


x1 <- trimws(x1)


x2 <- str_squish(x1)
 
 

sen <- x2[4]
sen <- as.data.frame(sen)

sen <- rbind(sen, x2[6])

sen <- rbind(sen, x2[9])
sen <- rbind(sen, x2[10])
sen <- rbind(sen, x2[13])
sen <- rbind(sen, x2[14])
sen <- rbind(sen, x2[16])
sen <- rbind(sen, x2[17])
sen <- rbind(sen, x2[20])
sen <- rbind(sen, x2[21])
sen <- rbind(sen, x2[24])
sen <- rbind(sen, x2[25])
sen <- rbind(sen, x2[27])
sen <- rbind(sen, x2[28])
sen <- rbind(sen, x2[30])
sen <- rbind(sen, x2[31])
sen <- rbind(sen, x2[33])
sen <- rbind(sen, x2[34])
sen <- rbind(sen, x2[36])
sen <- rbind(sen, x2[38])
sen <- rbind(sen, x2[41])
sen <- rbind(sen, x2[42])
sen <- rbind(sen, x2[45])
sen <- rbind(sen, x2[47])
sen <- rbind(sen, x2[49])
sen <- rbind(sen, x2[50])
 
#Separate information into separate columns

sen %>% separate(sen, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> sen2

sen2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", "votes"), 
                 sep = " ") -> sen2

sen2 <- sen2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)

hrc_sen <- sen2

#And now repeat for each page

######################Page 9 

#hrc[9]

senators2 <- hrc[9]

senators2 <- strsplit(senators2, "\n")

senators2 <- senators2[[1]]

#senators2

senators2 <- str_squish(senators2)

#senators2

sen <- senators2[4]
sen <- as.data.frame(sen)

sen <- rbind(sen, senators2[6])
sen <- rbind(sen, senators2[9])
sen <- rbind(sen, senators2[10])
sen <- rbind(sen, senators2[13])
sen <- rbind(sen, senators2[14])
sen <- rbind(sen, senators2[16])
sen <- rbind(sen, senators2[17])
sen <- rbind(sen, senators2[20])
sen <- rbind(sen, senators2[22])
sen <- rbind(sen, senators2[24])
sen <- rbind(sen, senators2[25])
sen <- rbind(sen, senators2[27])
sen <- rbind(sen, senators2[28])
sen <- rbind(sen, senators2[30])
sen <- rbind(sen, senators2[32])
sen <- rbind(sen, senators2[35])
sen <- rbind(sen, senators2[36])
sen <- rbind(sen, senators2[39])
sen <- rbind(sen, senators2[41])
sen <- rbind(sen, senators2[44])
sen <- rbind(sen, senators2[45])
sen <- rbind(sen, senators2[47])
sen <- rbind(sen, senators2[48])
sen <- rbind(sen, senators2[50])
sen <- rbind(sen, senators2[51])

sen %>% separate(sen, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> sen2

sen2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", "votes"), 
                 sep = " ") -> sen2

sen2 <- sen2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)

hrc_sen <- bind_rows(hrc_sen, sen2)


############## Page 10

#hrc[10]

senators2 <- hrc[10]

senators2 <- strsplit(senators2, "\n")

senators2 <- senators2[[1]]

#senators2

senators2 <- str_squish(senators2)

#senators2

sen <- senators2[4]
sen <- as.data.frame(sen)

sen <- rbind(sen, senators2[6])
sen <- rbind(sen, senators2[9])
sen <- rbind(sen, senators2[10])
sen <- rbind(sen, senators2[13])
sen <- rbind(sen, senators2[14])
sen <- rbind(sen, senators2[17])
sen <- rbind(sen, senators2[18])
sen <- rbind(sen, senators2[21])
sen <- rbind(sen, senators2[23])
sen <- rbind(sen, senators2[25])
sen <- rbind(sen, senators2[26])
sen <- rbind(sen, senators2[28])
sen <- rbind(sen, senators2[29])
sen <- rbind(sen, senators2[31])
sen <- rbind(sen, senators2[33])
sen <- rbind(sen, senators2[36])
sen <- rbind(sen, senators2[37])
sen <- rbind(sen, senators2[40])
sen <- rbind(sen, senators2[42])
sen <- rbind(sen, senators2[45])
sen <- rbind(sen, senators2[46])
sen <- rbind(sen, senators2[48])
sen <- rbind(sen, senators2[49])
sen <- rbind(sen, senators2[51])
sen <- rbind(sen, senators2[52])


sen %>% separate(sen, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> sen2

sen2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", "votes"), 
                 sep = " ") -> sen2

sen2 <- sen2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)

hrc_sen <- bind_rows(hrc_sen, sen2)

#Bob Casey's line gets messed up here


##################### Page 11

#hrc[11]

senators2 <- hrc[11]

senators2 <- strsplit(senators2, "\n")

senators2 <- senators2[[1]]

#senators2

senators2 <- str_squish(senators2)

#senators2

sen <- senators2[4]
sen <- as.data.frame(sen)

sen <- rbind(sen, senators2[6])
sen <- rbind(sen, senators2[9])
sen <- rbind(sen, senators2[10])
sen <- rbind(sen, senators2[13])
sen <- rbind(sen, senators2[14])
sen <- rbind(sen, senators2[17])
sen <- rbind(sen, senators2[18])
sen <- rbind(sen, senators2[21])
sen <- rbind(sen, senators2[23])
sen <- rbind(sen, senators2[25])
sen <- rbind(sen, senators2[26])
sen <- rbind(sen, senators2[28])
sen <- rbind(sen, senators2[29])
sen <- rbind(sen, senators2[31])
sen <- rbind(sen, senators2[32])
sen <- rbind(sen, senators2[35])
sen <- rbind(sen, senators2[36])
sen <- rbind(sen, senators2[39])
sen <- rbind(sen, senators2[41])
sen <- rbind(sen, senators2[44])
sen <- rbind(sen, senators2[45])


sen %>% separate(sen, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> sen2

sen2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", "votes"), 
                 sep = " ") -> sen2

sen2 <- sen2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)

hrc_sen <- bind_rows(hrc_sen, sen2)


################ REPRESENTATIVES

#I'm not going to change the variable names because I'm lazy
#Yes, I am using terrible variable naming practices :')

############### Page 17

#hrc[17]

senators2 <- hrc[17]

senators2 <- strsplit(senators2, "\n")

senators2 <- senators2[[1]]

#senators2

senators2 <- str_squish(senators2)

#senators2


sen <- senators2[5]
sen <- as.data.frame(sen)

sen <- rbind(sen, senators2[6])
sen <- rbind(sen, senators2[7])
sen <- rbind(sen, senators2[9])
sen <- rbind(sen, senators2[11])
sen <- rbind(sen, senators2[12])
sen <- rbind(sen, senators2[13])
sen <- rbind(sen, senators2[16])
sen <- rbind(sen, senators2[19])
sen <- rbind(sen, senators2[20])
sen <- rbind(sen, senators2[21])
sen <- rbind(sen, senators2[24])
sen <- rbind(sen, senators2[27])
sen <- rbind(sen, senators2[28])
sen <- rbind(sen, senators2[29])
sen <- rbind(sen, senators2[30])
sen <- rbind(sen, senators2[32])
sen <- rbind(sen, senators2[34])
sen <- rbind(sen, senators2[35])
sen <- rbind(sen, senators2[36])
sen <- rbind(sen, senators2[38])
sen <- rbind(sen, senators2[40])
sen <- rbind(sen, senators2[41])
sen <- rbind(sen, senators2[42])
sen <- rbind(sen, senators2[43])
sen <- rbind(sen, senators2[44])
sen <- rbind(sen, senators2[45])
sen <- rbind(sen, senators2[46])
sen <- rbind(sen, senators2[47])
sen <- rbind(sen, senators2[49])
sen <- rbind(sen, senators2[50])
sen <- rbind(sen, senators2[52])
sen <- rbind(sen, senators2[53])


sen %>% separate(sen, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> sen2

sen2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", "votes"), 
                 sep = " ") -> sen2

sen2 <- sen2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)

hrc_rep <- sen2


############### Page 18

#hrc[18]

senators2 <- hrc[18]

senators2 <- strsplit(senators2, "\n")

senators2 <- senators2[[1]]

#senators2

senators2 <- str_squish(senators2)

#senators2

#new easier method
senators2 <- as.data.frame(senators2)

senators2 %>% filter(str_detect(senators2, "\\)")) -> senators2

#senators2 <- senators2[-1,]

senators2 <- senators2 %>% filter(senators2 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")


senators2 %>% separate(senators2, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> senators2

senators2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", "votes"), 
                 sep = " ") -> senators2

senators2 <- senators2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)

hrc_rep <- bind_rows(hrc_rep, senators2)

##################### Page 19

#hrc[19]

senators2 <- hrc[19]

senators2 <- strsplit(senators2, "\n")

senators2 <- senators2[[1]]

#senators2

senators2 <- str_squish(senators2)

#senators2

#new easier method
senators2 <- as.data.frame(senators2)

senators2 %>% filter(str_detect(senators2, "\\)")) -> senators2

#senators2 <- senators2[-1,]

senators2 <- senators2 %>% filter(senators2 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

senators2 %>% separate(senators2, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> senators2

senators2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", "votes"), 
                 sep = " ") -> senators2

senators2 <- senators2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)

hrc_rep <- bind_rows(hrc_rep, senators2)

################ Page 20

#hrc[20]

senators2 <- hrc[20]

senators2 <- strsplit(senators2, "\n")

senators2 <- senators2[[1]]

#senators2

senators2 <- str_squish(senators2)

#senators2

#new easier method
senators2 <- as.data.frame(senators2)

senators2 %>% filter(str_detect(senators2, "\\)")) -> senators2

#senators2 <- senators2[-1,]

senators2 <- senators2 %>% filter(senators2 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

senators2 %>% separate(senators2, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> senators2

senators2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", "votes"), 
                 sep = " ") -> senators2

senators2 <- senators2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)

hrc_rep <- bind_rows(hrc_rep, senators2)

################# Page 21
#hrc[21]

senators2 <- hrc[21]

senators2 <- strsplit(senators2, "\n")

senators2 <- senators2[[1]]

#senators2

senators2 <- str_squish(senators2)

#senators2

#new easier method
senators2 <- as.data.frame(senators2)

senators2 %>% filter(str_detect(senators2, "\\)")) -> senators2

#senators2 <- senators2[-1,]

senators2 <- senators2 %>% filter(senators2 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

senators2 %>% separate(senators2, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> senators2

senators2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", "votes"), 
                 sep = " ") -> senators2

senators2 <- senators2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)

hrc_rep <- bind_rows(hrc_rep, senators2)

################### Page 22

#hrc[22]
senators2 <- hrc[22]
senators2 <- strsplit(senators2, "\n")
senators2 <- senators2[[1]]
#senators2
senators2 <- str_squish(senators2)
#senators2
senators2 <- as.data.frame(senators2)
senators2 %>% filter(str_detect(senators2, "\\)")) -> senators2
senators2 <- senators2 %>% filter(senators2 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")


senators2 %>% separate(senators2, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> senators2

senators2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", "votes"), 
                 sep = " ") -> senators2

senators2 <- senators2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)

hrc_rep <- bind_rows(hrc_rep, senators2)


################ Page 23

#hrc[23]
senators2 <- hrc[23]
senators2 <- strsplit(senators2, "\n")
senators2 <- senators2[[1]]
#senators2
senators2 <- str_squish(senators2)
#senators2

senators2 <- as.data.frame(senators2)
senators2 %>% filter(str_detect(senators2, "\\)")) -> senators2
senators2 <- senators2 %>% filter(senators2 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")


senators2 %>% separate(senators2, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> senators2

senators2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", "votes"), 
                 sep = " ") -> senators2

senators2 <- senators2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)

hrc_rep <- bind_rows(hrc_rep, senators2)


################ Page 24
#hrc[24]
senators2 <- hrc[24]
senators2 <- strsplit(senators2, "\n")
senators2 <- senators2[[1]]
#senators2
senators2 <- str_squish(senators2)
#senators2


senators2 <- as.data.frame(senators2)
senators2 %>% filter(str_detect(senators2, "\\)")) -> senators2
senators2 <- senators2 %>% filter(senators2 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")


senators2 %>% separate(senators2, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> senators2

senators2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", "votes"), 
                 sep = " ") -> senators2

senators2 <- senators2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)

hrc_rep <- bind_rows(hrc_rep, senators2)

################# Page 25

#hrc[25]
senators2 <- hrc[25]
senators2 <- strsplit(senators2, "\n")
senators2 <- senators2[[1]]
#senators2
senators2 <- str_squish(senators2)
#senators2

senators2 <- as.data.frame(senators2)
senators2 %>% filter(str_detect(senators2, "\\)")) -> senators2
senators2 <- senators2 %>% filter(senators2 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

senators2 %>% separate(senators2, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> senators2

senators2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", "votes"), 
                 sep = " ") -> senators2

senators2 <- senators2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)

hrc_rep <- bind_rows(hrc_rep, senators2)

################# Page 26

#hrc[26]
senators2 <- hrc[26]
senators2 <- strsplit(senators2, "\n")
senators2 <- senators2[[1]]
#senators2
senators2 <- str_squish(senators2)
#senators2


senators2 <- as.data.frame(senators2)
senators2 %>% filter(str_detect(senators2, "\\)")) -> senators2
senators2 <- senators2 %>% filter(senators2 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

senators2 %>% separate(senators2, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> senators2

senators2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", "votes"), 
                 sep = " ") -> senators2

senators2 <- senators2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)

hrc_rep <- bind_rows(hrc_rep, senators2)


################### Page 27

#hrc[27]
senators2 <- hrc[27]
senators2 <- strsplit(senators2, "\n")
senators2 <- senators2[[1]]
#senators2
senators2 <- str_squish(senators2)
#senators2


senators2 <- as.data.frame(senators2)
senators2 %>% filter(str_detect(senators2, "\\)")) -> senators2
senators2 <- senators2 %>% filter(senators2 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")



senators2 %>% separate(senators2, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> senators2

senators2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", "votes"), 
                 sep = " ") -> senators2

senators2 <- senators2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)

hrc_rep <- bind_rows(hrc_rep, senators2)

############### Page 28

#hrc[28]
senators2 <- hrc[28]
senators2 <- strsplit(senators2, "\n")
senators2 <- senators2[[1]]
#senators2
senators2 <- str_squish(senators2)
#senators2

senators2 <- as.data.frame(senators2)
senators2 %>% filter(str_detect(senators2, "\\)")) -> senators2
senators2 <- senators2 %>% filter(senators2 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")


senators2 %>% separate(senators2, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> senators2

senators2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", "votes"), 
                 sep = " ") -> senators2

senators2 <- senators2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)

hrc_rep <- bind_rows(hrc_rep, senators2)

################## Page 29

#hrc[29]
senators2 <- hrc[29]
senators2 <- strsplit(senators2, "\n")
senators2 <- senators2[[1]]
#senators2
senators2 <- str_squish(senators2)
#senators2

#new easier method
senators2 <- as.data.frame(senators2)
senators2 %>% filter(str_detect(senators2, "\\)")) -> senators2
senators2 <- senators2 %>% filter(senators2 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")


senators2 %>% separate(senators2, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> senators2

senators2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", "votes"), 
                 sep = " ") -> senators2

senators2 <- senators2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)

hrc_rep <- bind_rows(hrc_rep, senators2)

################### Page 30

#hrc[30]
senators2 <- hrc[30]
senators2 <- strsplit(senators2, "\n")
senators2 <- senators2[[1]]
#senators2
senators2 <- str_squish(senators2)
#senators2

senators2 <- as.data.frame(senators2)
senators2 %>% filter(str_detect(senators2, "\\)")) -> senators2
senators2 <- senators2 %>% filter(senators2 != "REPRESENTATIVE (Party) SCORE SCORE SCORE")

senators2 %>% separate(senators2, into = c("name", "score1", "score2", "score3", "votes"), 
                 sep = "\\)") -> senators2

senators2 %>% separate(score1, into = c("score1", "score2", "score3", "score4", "votes"), 
                 sep = " ") -> senators2

senators2 <- senators2 %>% select(-score1) %>%
  rename(score1 = score2, score2 = score3, score3 = score4) %>%
  select(-votes)

hrc_rep <- bind_rows(hrc_rep, senators2)


```



### Output{.tabset}

Here are the members of the 117th Congress and their HRC scores



#### Representatives

```{r}
hrc_rep <- hrc_rep %>%
  rename(score_117 = score1,
         score_116 = score2,
         score_115 = score3)

#clean up names

hrc_rep %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5",
                          "spot6", "spot7","spot8","spot9","spot10"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot2, "\\,")) %>%
  select(-spot1, -spot4:-spot10 )%>%
  rename(last_name = spot2, first_name = spot3) -> hrc_rep_df


hrc_rep %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5",
                          "spot6", "spot7","spot8","spot9","spot10"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot3, "\\,")) %>%
  select(-spot1) %>%
  mutate(spot2 = case_when(
    spot2 == "13" ~ NA_character_,
    spot2 == "51" ~ NA_character_,
    spot2 == "19" ~ NA_character_,
    spot2 == "8" ~ NA_character_,
    spot2 == "11" ~ NA_character_,
    spot2 == "7" ~ NA_character_,
    TRUE ~ spot2
  )) %>%
  unite("last_name", spot2, spot3, sep = " ", na.rm= T) %>%
  rename(first_name = spot4) %>%
  select(-spot5:-spot10) -> hrc_rep_df2
  
hrc_rep_df <- bind_rows(hrc_rep_df, hrc_rep_df2)


hrc_rep %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5",
                          "spot6", "spot7","spot8","spot9","spot10"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot4, "\\,")) %>%
  select(-spot1:-spot3) %>%
  rename(last_name = spot4) %>%
  unite("first_name", spot5, spot6, sep = " ", na.rm = T) %>%
  select(-spot7:-spot10) -> hrc_rep_df2

hrc_rep_df <- bind_rows(hrc_rep_df, hrc_rep_df2)

hrc_rep %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5",
                          "spot6", "spot7","spot8","spot9","spot10"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot5, "\\,")) %>%
  select(-spot1:-spot3) %>%
  mutate(spot4 = case_when(
    spot4 %in% c("1","2","3","4","5","6","9","10","12","13","14","15","24",
                 "26", "34", "36", "53", "21", "23") ~ NA_character_,
    TRUE ~ spot4
  )) %>%
  unite("last_name", spot4, spot5, sep = " ", na.rm = T) %>%
  rename(first_name = spot6) %>%
  select(-spot7:-spot10) -> hrc_rep_df2

hrc_rep_df <- bind_rows(hrc_rep_df, hrc_rep_df2)


hrc_rep %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5",
                          "spot6", "spot7","spot8","spot9","spot10"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot6, "\\,")) %>%
  select(-spot1:-spot4) %>%
  mutate(spot5 = case_when(
    spot5 %in% c("1","2","3","4","5","6","9","10","12","13","14","15","24",
                 "26","34","36","53","21","23","11","17","AL","25","19",
                 "37", "39","7") ~ NA_character_,
    TRUE ~ spot5
  )) %>%
  unite("last_name", spot5, spot6, sep = " ", na.rm = T) %>%
  rename(first_name = spot7) %>%
  select(-spot8:-spot10) -> hrc_rep_df2

hrc_rep_df <- bind_rows(hrc_rep_df, hrc_rep_df2)

hrc_rep %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5",
                          "spot6", "spot7","spot8","spot9","spot10"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot7, "\\,")) %>%
  select(-spot1:-spot5) %>%
  unite("last_name", spot6, spot7, sep = " ") %>%
  select(-spot9:-spot10)%>%
  rename(first_name = spot8) -> hrc_rep_df2

hrc_rep_df <- bind_rows(hrc_rep_df, hrc_rep_df2)

hrc_rep_df %>% unite("name", first_name, last_name, sep = " ", remove = F) %>%
  mutate(name = str_replace(name, "[[:punct:]]", "")) -> hrc_rep_df


hrc_rep_df$name <- str_squish(hrc_rep_df$name)

hrc_rep_df %>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(height = "400px")
```


#### Senators


```{r}

#rename score variabels
hrc_sen <- hrc_sen %>%
  rename(score_117 = score1,
         score_116 = score2,
         score_115 = score3)

#clean up names

hrc_sen %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot1, "\\,")) %>%
  select(-spot3, -spot4, -spot5)%>%
  rename(last_name = spot1, first_name = spot2) -> hrc_sen_df



hrc_sen %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot2, "\\,")) %>%
  unite("last_name", spot1, spot2, sep = " ") %>%
  select(-spot4, -spot5) %>%
  rename(first_name = spot3) -> hrc_sen_df2

hrc_sen_df <- bind_rows(hrc_sen_df, hrc_sen_df2)


hrc_sen %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot3, "\\,")) %>%
  select(-spot1, -spot2, -spot5) %>%
  rename(last_name = spot3, first_name = spot4) -> hrc_sen_df2

hrc_sen_df <- bind_rows(hrc_sen_df, hrc_sen_df2)


hrc_sen %>% separate(name, into = c("Name", "ID"),
                     sep = "\\(") %>%
  separate(Name, into = c("spot1", "spot2", "spot3", "spot4", "spot5"),
           sep = "[[:blank:]]") %>%
  filter(str_detect(spot4, "\\,")) %>%
  select(-spot1, -spot2, -spot3) %>%
  rename(last_name = spot4, first_name = spot5) -> hrc_sen_df2

hrc_sen_df <- bind_rows(hrc_sen_df, hrc_sen_df2)

#make a new column with their name
hrc_sen_df <- hrc_sen_df %>% unite("name", first_name, last_name, sep = " ", remove = F) 

hrc_sen_df <- hrc_sen_df %>% mutate(name = str_replace_all(name,"[[:punct:]]", ""))

hrc_sen_df$name <- str_squish(hrc_sen_df$name)

#Robert/Bob Casey's name got messed up 
hrc_sen_df <- hrc_sen_df %>% 
  mutate(name = case_when(
  name == "Robert Jr" ~ "Bob Casey",
  TRUE ~ name),
  last_name = case_when(
    last_name == "Jr.," ~ "Casey Jr.",
TRUE ~ last_name
))

hrc_sen_df %>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(height = "400px")

```




# ASHA's Spending by HRC Score{.tabset}

```{r}
#Make sure names align across DFs

### Representatives

hrc_rep_df$name <- str_squish(hrc_rep_df$name)

hrc_rep_df %>% mutate(name = case_when(
  name == "Frank Pallone Jr," ~ "Frank Pallone Jr.",
  name == "Joe Neguse" ~ "Joseph Neguse",
  name == "GK. Butterfield," ~ "G K Butterfield",
  name == "Lauren Underwood" ~ "Lauren A Underwood",
  name == "Robert Latta" ~ "Bob Latta",
  name == "Robert Scott" ~ "Bobby Scott",
  name == "Richard Neal" ~ "Richard E Neal",
  name == "Bobby Rush" ~ "Bobby L Rush",
  name == "Steny Hoyer" ~ "Steny H Hoyer",
  name == "Vern Buchanan" ~ "Vernon Buchanan",
  name == "Matthew Cartwright" ~ "Matt Cartwright",
  name == "Yvette Clarke" ~ "Yvette D Clarke",
  name == "James Clyburn" ~ "James E Clyburn",
  name == "Danny Davis" ~ "Danny K Davis",
  name == "Tom OHalleran," ~ "Tom O'Halleran",
  name == "Bill Pascrell Jr," ~ "Bill Pascrell Jr.",
  name == "Lucille RoybalAllard," ~ "Lucille Roybal-Allard",
  name == "Terri Sewell" ~ "Terri A Sewell",
  name == "Thomas Suozzi" ~ "Tom Suozzi",
  TRUE ~ name
)) -> hrc_rep_df

ashaPAC %>% mutate(name = case_when(
  name == "Mark Desaulnier" ~ "Mark DeSaulnier",
  name == "David P Joyce" ~ "David Joyce",
  name == "Nanette Barragan" ~ "Nanette Barrag치n",
  name == "Tony Cardenas" ~ "Tony C치rdenas",
  name == "Yvette Clarke" ~ "Yvette D Clarke",
  name == "Linda Sanchez" ~ "Linda S치nchez",
  name == "Terri Sewell" ~ "Terri A Sewell",

  TRUE ~ name
)) -> ashaPAC

```




```{r}

#The following names are Representatives not in the HRC data for the 117th congress. The ones who are not included were in the 116th congress. Their data will be manually added based on the [HRC's report on the 116th Congress](https://hrc-prod-requests.s3-us-west-2.amazonaws.com/116th-Congressional-Scorecard-060921.pdf).   

# ashaPAC %>% filter(role == "Representative") %>%
#   anti_join(hrc_rep_df, by = "name") %>%
#     kbl(table.attr = "style = \"color: black;\"") %>%
#   kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
#   scroll_box(height = "400px")
```


```{r}
### Clean up the names of the Senators

hrc_sen_df$name <- str_squish(hrc_sen_df$name)

hrc_sen_df %>% mutate(name = case_when(
  name == "Charles Schumer" ~ "Chuck Schumer",
  name == "Cindy HydeSmith" ~ "Cindy Hyde-Smith",
  name == "William Cassidy" ~ "Bill Cassidy",
  name == "Richard Durbin" ~ "Dick Durbin",
  name == "Shelley Capito" ~ "Shelley Moore Capito",
  TRUE ~ name
)) -> hrc_sen_df

ashaPAC %>% mutate(name = case_when(
  name == "Ben Ray Lujan" ~ "Ben Luj치n",
  TRUE ~ name
)) -> ashaPAC


```



```{r}
#Senators whose names don't match up:

# ashaPAC %>% filter(role == "Senator") %>%
#   anti_join(hrc_sen_df, by = "name") %>%
#   kbl(table.attr = "style = \"color: black;\"") %>%
#   kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
#   scroll_box(height = "400px")
```



```{r}
#More cleaning of the data

#Change columns to numeric and not characters
hrc_rep_df$score_117 <- as.numeric(hrc_rep_df$score_117)
hrc_rep_df$score_116 <- as.numeric(hrc_rep_df$score_116)
hrc_rep_df$score_115 <- as.numeric(hrc_rep_df$score_115)


hrc_sen_df$score_117 <- as.numeric(hrc_sen_df$score_117)
hrc_sen_df$score_116 <- as.numeric(hrc_sen_df$score_116)
hrc_sen_df$score_115 <- as.numeric(hrc_sen_df$score_115)

#Remove dollar sign from asha total

ashaPAC <- ashaPAC %>% mutate(ASHA_total = str_replace_all(ASHA_total, "\\$", ""))
ashaPAC$ASHA_total<-as.numeric(ashaPAC$ASHA_total)


```




## 2022{.tabset}


### Senators

Senators, their HRC scores, and the amount that ASHA has donated to their 2022 campaigns.

```{r}
#Combine data from HRC and ASHA spending

ashaPAC %>% select(name, party, state, ASHA_total, year, role) %>%
  filter(year == "2022", role == "Senator") %>%
  left_join(hrc_sen_df %>% select(name,score_117:score_115), by = "name") -> asha_2022_sen

#add Markwayne Mullin's info from Representative HRC data

asha_2022_sen <- asha_2022_sen %>% 
  mutate(score_117 = case_when(
  name == "Markwayne Mullin" ~ 6,
  TRUE ~ score_117),
  score_116 = case_when(
  name == "Markwayne Mullin" ~ 0,
  TRUE ~ score_116),
  score_115 = case_when(
  name == "Markwayne Mullin" ~ 0,
  TRUE ~ score_115),
  )

asha_2022_sen %>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(height = "400px")
```


#### Total $ Donated

```{r}
paste("The total amount of money ASHA donated to Senators' 2022 Campaigns:", sum(asha_2022_sen$ASHA_total), "dollars.")
```

#### Money by HRC Rating

Let's split the scores into 0, 1-25, 26-50, 51-75, and 75-100 and see how much money is spent.

```{r}
asha_2022_sen <- asha_2022_sen %>%
  mutate(groups_117 = case_when(
    score_117 == 0 ~ "0",
    score_117 <= 25 ~ "1-25",
    score_117 <= 50 ~ "26-50",
    score_117 <= 75 ~ "51-75",
    score_117 <= 100 ~ "76-100"
  ))

asha_2022_sen %>% 
  group_by(groups_117) %>%
  summarise(n = n(), money_spent = sum(ASHA_total),
            percent_spent = round((money_spent/43000)*100,2)) %>%
  as_tibble() %>% rmarkdown::paged_table()
```

ASHA donated: 

- $14,000 to campaigns given an HRC score of less than 25 

- $6,000 to campaigns given an HRC score between 51-75

- $20,500 to campaigns given an HRC score above 75


Approximately a third of their donations went towards candidates with a score of less than 25.

### Representatives

```{r}
ashaPAC %>% select(name, party, state, ASHA_total, year, role) %>%
  filter(year == "2022", role == "Representative") %>%
  left_join(hrc_rep_df %>% select(name,score_117:score_115), by = "name") -> asha_2022_rep


asha_2022_rep %>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(height = "400px")
```

#### Total $ Donated

```{r}
paste("The total amount of money ASHA donated to Representatives' 2022 Campaigns:", sum(asha_2022_rep$ASHA_total), "dollars.")
```

#### Money by HRC Rating

```{r}
asha_2022_rep <- asha_2022_rep %>%
  mutate(groups_117 = case_when(
    score_117 == 0 ~ "0",
    score_117 <= 25 ~ "1-25",
    score_117 <= 50 ~ "26-50",
    score_117 <= 75 ~ "51-75",
    score_117 <= 100 ~ "76-100"
  ))

asha_2022_rep %>% 
  group_by(groups_117) %>%
  summarise(n = n(), money_spent = sum(ASHA_total),
            percent_spent = round((money_spent/126500)*100,2)) %>%
  as_tibble() %>% rmarkdown::paged_table()
```


ASHA donated: 

- $32,000 to campaigns given an HRC score of 0 (over 25% of the total money spent)

- $12,000 to campaigns given an HRC score of less than 25 

- $6,000 to campaigns given an HRC score between 26-50

- $76,500 to campaigns given an HRC score above 75

That's $50,000 to campaigns with a score less than 50, or ~40% of their campaign donations.

```{r}
# asha_2022_rep %>%
#   ggplot(aes(groups_117, ASHA_total)) + geom_bar(stat = "identity")


# asha_2022_rep %>%
#   ggplot(aes(groups_117, ASHA_total)) + 
#   geom_boxplot(width = .5, outlier.shape = NA) +
#   geom_jitter(width = .1, alpha = .5)+
#   theme_minimal() +
#   labs(x = "HRC Rating in 25pt intervals",
#        y = "Inidivudal Campaign Donations Amount ($)",
#        title = "ASHA's 2022 Representative Campaign Donations")+
#   theme(plot.title = element_text(hjust = .5))
```


## 2020{.tabset}


### Senators

```{r}
ashaPAC %>% select(name, party, state, ASHA_total, year, role) %>%
  filter(year == "2020", role == "Senator") %>%
  left_join(hrc_sen_df %>% select(name,score_117:score_115), by = "name") -> asha_2020_sen

asha_2020_sen <- asha_2020_sen %>%
  mutate(score_116 = case_when(
    name == "Joe Kennedy III" ~ 100,
    TRUE ~ score_116),
    score_115 = case_when(
    name == "Joe Kennedy III" ~ 100,
    TRUE ~ score_115
    ))

asha_2020_sen %>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(height = "400px")
```

#### Total $ Donated

```{r}
paste("The total amount of money ASHA donated to Senators' 2020 Campaigns:", sum(asha_2020_sen$ASHA_total), "dollars.")
```

#### Money by HRC Rating

```{r}
asha_2020_sen <- asha_2020_sen %>%
  mutate(groups_117 = case_when(
    score_117 == 0 ~ "0",
    score_117 <= 25 ~ "1-25",
    score_117 <= 50 ~ "26-50",
    score_117 <= 75 ~ "51-75",
    score_117 <= 100 ~ "76-100"
  ))

asha_2020_sen %>% 
  group_by(groups_117) %>%
  summarise(n = n(), money_spent = sum(ASHA_total),
            percent_spent = round((money_spent/27500)*100,2)) %>%
  as_tibble() %>% rmarkdown::paged_table()
```

ASHA donated: 

- $9,000 to campaigns given an HRC score less than 25 

- $3,500 to campaigns given an HRC score between 51-75

- $14,000 to campaigns given an HRC score above 75

Approximately a third of their donations went towards candidates with a score of less than 25.

### Representatives

```{r}
ashaPAC %>% select(name, party, state, ASHA_total, year, role) %>%
  filter(year == "2020", role == "Representative") %>%
  left_join(hrc_rep_df %>% select(name,score_117:score_115), by = "name") -> asha_2020_rep

#asha_2020_rep %>% filter(is.na(score_116))


asha_2020_rep <- asha_2020_rep %>%
  mutate(
    score_116 = case_when(
      name == "Donna Shalala" ~ 100, #na for 115
      name == "Nita M Lowey" ~ 100, #100 for 115
      name == "Greg Walden" ~ 47, #0 for 115
      name == "Kendra Horn" ~ 88, #NA for 115
      name == "Anthony Brindisi" ~ 88, #NA for 115
      name == "George Holding" ~ 0, # 0 for 115
      #name == "John Lewis" ~
      name == "Pete Olson" ~ 7, #0 for 115
      name == "Tom Reed" ~ 47, #43 for 115
      name == "Steve Stivers" ~ 28, #0 for 115,
      TRUE ~ score_116
    ),
     score_115 = case_when(
     # name == "Donna Shalala" ~ 100, #na for 115
      name == "Nita M Lowey" ~ 100, #100 for 115
      name == "Greg Walden" ~ 0, #0 for 115
     # name == "Kendra Horn" ~ 88, #NA for 115
     # name == "Anthony Brindisi" ~ 88, #NA for 115
      name == "George Holding" ~ 0, # 0 for 115
      #name == "John Lewis" ~
      name == "Pete Olson" ~ 0, #0 for 115
      name == "Tom Reed" ~ 43, #43 for 115
      name == "Steve Stivers" ~ 0, #0 for 115,
      TRUE ~ score_115)
  )


asha_2020_rep %>%
  kbl(table.attr = "style = \"color: black;\"") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), position = "center") %>%
  scroll_box(height = "400px")

```

#### Total $ Donated

```{r}
paste("The total amount of money ASHA donated to Representatives' 2020 Campaigns:", sum(asha_2020_rep$ASHA_total), "dollars.")
```

#### Money by HRC Rating

```{r}
asha_2020_rep <- asha_2020_rep %>%
  mutate(groups_117 = case_when(
    score_117 == 0 ~ "0",
    score_117 <= 25 ~ "1-25",
    score_117 <= 50 ~ "26-50",
    score_117 <= 75 ~ "51-75",
    score_117 <= 100 ~ "76-100"
  ))

asha_2020_rep %>% 
  group_by(groups_117) %>%
  summarise(n = n(), money_spent = sum(ASHA_total),
            percent_spent = round((money_spent/265500)*100,2)) %>%
  as_tibble() %>% rmarkdown::paged_table()
```

ASHA donated: 

- $56,000 to campaigns given an HRC score of 0 (over 21% of the total money spent)

- $27,500 to campaigns given an HRC score of less than 25 

- $4,000 to campaigns given an HRC score between 26-50

- $3,500 to campaigns given an HRC score between 51-75

- $157,500 to campaigns given an HRC score above 75

$87,500 or approximately 32.96% of their total campaign spending went towards campaigns with a score of less than 50 in 2020. 












